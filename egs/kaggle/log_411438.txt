I am process 31959, running on gpu38: starting (Thu May 11 14:19:57 2023)
args:  Namespace(data_train='./data/datafiles/train.json', data_val='./data/datafiles/eval.json', data_eval='./data/datafiles/test.json', label_csv='./data/class_labels_indices.csv', n_class=88, model='ast', dataset='audioset', exp_dir='./exp/ast-attempt1-kagglemean', lr=1e-05, optim='adam', batch_size=12, num_workers=0, n_epochs=30, lr_patience=2, n_print_steps=100, save_model=True, freqm=24, timem=96, mixup=0.0, bal='bal', fstride=10, tstride=10, imagenet_pretrain=True, audioset_pretrain=True, dataset_mean=-0.000321335, dataset_std=0.003499322, audio_length=512, noise=False, metrics='mAP', loss='BCE', warmup=False, lrscheduler_start=5, lrscheduler_step=1, lrscheduler_decay=0.85, wa=True, wa_start=1, wa_end=5)
now train a audio spectrogram transformer model
balanced sampler is being used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
---------------AST Model Summary---------------
ImageNet pretraining: True, AudioSet pretraining: True
frequncey stride=10, time stride=10
number of patches=600

Creating experiment directory: ./exp/ast-attempt1-kagglemean
Now starting training for 30 epochs
running on cuda
Total parameter number is : 87.324 million
Total trainable parameter number is : 87.324 million
now training with audioset, main metrics: mAP, loss function: BCEWithLogitsLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fc22b683d60>
The learning rate scheduler starts at 5 epoch with decay rate of 0.850 every 1 epochs
current #steps=0, #epochs=1
start training...
---------------
2023-05-11 14:20:17.567592
current #epochs=1, #steps=0
start validation
mAP: 0.101055
AUC: 0.527500
Avg Precision: 0.083627
Avg Recall: 1.000000
d_prime: 0.097561
train_loss: 0.367527
valid_loss: 0.778101
validation finished
Epoch-1 lr: 1e-05
epoch 1 training time: 64.492
---------------
2023-05-11 14:21:22.060083
current #epochs=2, #steps=48
start validation
mAP: 0.107661
AUC: 0.536637
Avg Precision: 0.096164
Avg Recall: 1.000000
d_prime: 0.130058
train_loss: 0.201219
valid_loss: 0.756825
validation finished
Epoch-2 lr: 1e-05
epoch 2 training time: 28.804
---------------
2023-05-11 14:21:50.864753
current #epochs=3, #steps=96
Epoch: [3][4/48]	Per Sample Total Time 0.03345	Per Sample Data Time 0.01000	Per Sample DNN Time 0.02345	Train Loss 0.1854	
start validation
mAP: 0.114606
AUC: 0.559574
Avg Precision: 0.097319
Avg Recall: 1.000000
d_prime: 0.211976
train_loss: 0.177100
valid_loss: 0.745839
validation finished
Epoch-3 lr: 1e-05
epoch 3 training time: 26.486
---------------
2023-05-11 14:22:17.350512
current #epochs=4, #steps=144
start validation
mAP: 0.114086
AUC: 0.585021
Avg Precision: 0.095796
Avg Recall: 1.000000
d_prime: 0.303709
train_loss: 0.163811
valid_loss: 0.737941
validation finished
Epoch-4 lr: 1e-05
epoch 4 training time: 20.623
---------------
2023-05-11 14:22:37.973117
current #epochs=5, #steps=192
Epoch: [5][8/48]	Per Sample Total Time 0.02859	Per Sample Data Time 0.00521	Per Sample DNN Time 0.02338	Train Loss 0.1609	
start validation
mAP: 0.112404
AUC: 0.583645
Avg Precision: 0.095346
Avg Recall: 1.000000
d_prime: 0.298719
train_loss: 0.156026
valid_loss: 0.732508
validation finished
Epoch-5 lr: 8.5e-06
epoch 5 training time: 19.730
---------------
2023-05-11 14:22:57.703034
current #epochs=6, #steps=240
start validation
mAP: 0.114289
AUC: 0.595791
Avg Precision: 0.096896
Avg Recall: 1.000000
d_prime: 0.342900
train_loss: 0.148319
valid_loss: 0.728440
validation finished
Epoch-6 lr: 7.2249999999999994e-06
epoch 6 training time: 20.670
---------------
2023-05-11 14:23:18.373317
current #epochs=7, #steps=288
Epoch: [7][12/48]	Per Sample Total Time 0.03637	Per Sample Data Time 0.01272	Per Sample DNN Time 0.02364	Train Loss 0.1455	
start validation
mAP: 0.115203
AUC: 0.602623
Avg Precision: 0.099792
Avg Recall: 1.000000
d_prime: 0.367898
train_loss: 0.142734
valid_loss: 0.725609
validation finished
Epoch-7 lr: 6.141249999999999e-06
epoch 7 training time: 22.488
---------------
2023-05-11 14:23:40.860292
current #epochs=8, #steps=336
start validation
mAP: 0.114026
AUC: 0.595418
Avg Precision: 0.098291
Avg Recall: 1.000000
d_prime: 0.341538
train_loss: 0.140040
valid_loss: 0.723570
validation finished
Epoch-8 lr: 5.220062499999999e-06
epoch 8 training time: 18.987
---------------
2023-05-11 14:23:59.847911
current #epochs=9, #steps=384
Epoch: [9][16/48]	Per Sample Total Time 0.02853	Per Sample Data Time 0.00497	Per Sample DNN Time 0.02356	Train Loss 0.1408	
start validation
mAP: 0.112091
AUC: 0.594421
Avg Precision: 0.100357
Avg Recall: 1.000000
d_prime: 0.337903
train_loss: 0.138813
valid_loss: 0.722094
validation finished
Epoch-9 lr: 4.4370531249999995e-06
epoch 9 training time: 19.107
---------------
2023-05-11 14:24:18.953743
current #epochs=10, #steps=432
start validation
mAP: 0.119219
AUC: 0.600408
Avg Precision: 0.101307
Avg Recall: 1.000000
d_prime: 0.359779
train_loss: 0.134339
valid_loss: 0.721124
validation finished
Epoch-10 lr: 3.7714951562499997e-06
epoch 10 training time: 21.562
---------------
2023-05-11 14:24:40.516304
current #epochs=11, #steps=480
Epoch: [11][20/48]	Per Sample Total Time 0.02897	Per Sample Data Time 0.00484	Per Sample DNN Time 0.02413	Train Loss 0.1360	
start validation
mAP: 0.127305
AUC: 0.612046
Avg Precision: 0.102564
Avg Recall: 1.000000
d_prime: 0.402563
train_loss: 0.135046
valid_loss: 0.719991
validation finished
Epoch-11 lr: 3.2057708828124997e-06
epoch 11 training time: 22.257
---------------
2023-05-11 14:25:02.773636
current #epochs=12, #steps=528
start validation
mAP: 0.126116
AUC: 0.611583
Avg Precision: 0.103077
Avg Recall: 1.000000
d_prime: 0.400855
train_loss: 0.134256
valid_loss: 0.719563
validation finished
Epoch-12 lr: 2.7249052503906246e-06
epoch 12 training time: 18.564
---------------
2023-05-11 14:25:21.337777
current #epochs=13, #steps=576
Epoch: [13][24/48]	Per Sample Total Time 0.02866	Per Sample Data Time 0.00501	Per Sample DNN Time 0.02365	Train Loss 0.1329	
start validation
mAP: 0.115040
AUC: 0.605616
Avg Precision: 0.102078
Avg Recall: 1.000000
d_prime: 0.378882
train_loss: 0.131955
valid_loss: 0.718944
validation finished
Epoch-13 lr: 2.316169462832031e-06
epoch 13 training time: 18.553
---------------
2023-05-11 14:25:39.891400
current #epochs=14, #steps=624
start validation
mAP: 0.121665
AUC: 0.609468
Avg Precision: 0.104461
Avg Recall: 1.000000
d_prime: 0.393057
train_loss: 0.133719
valid_loss: 0.718522
validation finished
Epoch-14 lr: 1.9687440434072264e-06
epoch 14 training time: 18.675
---------------
2023-05-11 14:25:58.567003
current #epochs=15, #steps=672
Epoch: [15][28/48]	Per Sample Total Time 0.02902	Per Sample Data Time 0.00526	Per Sample DNN Time 0.02376	Train Loss 0.1335	
start validation
mAP: 0.123208
AUC: 0.610224
Avg Precision: 0.105444
Avg Recall: 1.000000
d_prime: 0.395842
train_loss: 0.133350
valid_loss: 0.718412
validation finished
Epoch-15 lr: 1.6734324368961425e-06
epoch 15 training time: 18.623
---------------
2023-05-11 14:26:17.188778
current #epochs=16, #steps=720
start validation
mAP: 0.125409
AUC: 0.605721
Avg Precision: 0.107652
Avg Recall: 1.000000
d_prime: 0.379269
train_loss: 0.131623
valid_loss: 0.718153
validation finished
Epoch-16 lr: 1.422417571361721e-06
epoch 16 training time: 18.489
---------------
2023-05-11 14:26:35.678795
current #epochs=17, #steps=768
Epoch: [17][32/48]	Per Sample Total Time 0.02868	Per Sample Data Time 0.00494	Per Sample DNN Time 0.02374	Train Loss 0.1344	
start validation
mAP: 0.122969
AUC: 0.604917
Avg Precision: 0.107229
Avg Recall: 1.000000
d_prime: 0.376316
train_loss: 0.132340
valid_loss: 0.718022
validation finished
Epoch-17 lr: 1.2090549356574628e-06
epoch 17 training time: 18.468
---------------
2023-05-11 14:26:54.147117
current #epochs=18, #steps=816
start validation
mAP: 0.123929
AUC: 0.609298
Avg Precision: 0.108149
Avg Recall: 1.000000
d_prime: 0.392431
train_loss: 0.131036
valid_loss: 0.717676
validation finished
Epoch-18 lr: 1.0276966953088434e-06
epoch 18 training time: 18.699
---------------
2023-05-11 14:27:12.845462
current #epochs=19, #steps=864
Epoch: [19][36/48]	Per Sample Total Time 0.02946	Per Sample Data Time 0.00570	Per Sample DNN Time 0.02376	Train Loss 0.1291	
start validation
mAP: 0.122266
AUC: 0.612949
Avg Precision: 0.105929
Avg Recall: 1.000000
d_prime: 0.405897
train_loss: 0.130227
valid_loss: 0.717461
validation finished
Epoch-19 lr: 8.735421910125168e-07
epoch 19 training time: 19.716
---------------
2023-05-11 14:27:32.562062
current #epochs=20, #steps=912
start validation
mAP: 0.130805
AUC: 0.612152
Avg Precision: 0.113280
Avg Recall: 1.000000
d_prime: 0.402955
train_loss: 0.130214
valid_loss: 0.717312
validation finished
Epoch-20 lr: 7.425108623606393e-07
epoch 20 training time: 21.959
---------------
2023-05-11 14:27:54.522273
current #epochs=21, #steps=960
Epoch: [21][40/48]	Per Sample Total Time 0.02902	Per Sample Data Time 0.00507	Per Sample DNN Time 0.02395	Train Loss 0.1291	
start validation
mAP: 0.130545
AUC: 0.616181
Avg Precision: 0.112342
Avg Recall: 1.000000
d_prime: 0.417851
train_loss: 0.129260
valid_loss: 0.717127
validation finished
Epoch-21 lr: 6.311342330065434e-07
epoch 21 training time: 19.096
---------------
2023-05-11 14:28:13.617585
current #epochs=22, #steps=1008
start validation
mAP: 0.129717
AUC: 0.616356
Avg Precision: 0.111542
Avg Recall: 1.000000
d_prime: 0.418498
train_loss: 0.130893
valid_loss: 0.717065
validation finished
Epoch-22 lr: 5.364640980555618e-07
epoch 22 training time: 18.473
---------------
2023-05-11 14:28:32.090771
current #epochs=23, #steps=1056
Epoch: [23][44/48]	Per Sample Total Time 0.02902	Per Sample Data Time 0.00503	Per Sample DNN Time 0.02399	Train Loss 0.1270	
start validation
mAP: 0.128936
AUC: 0.616252
Avg Precision: 0.111575
Avg Recall: 1.000000
d_prime: 0.418116
train_loss: 0.127167
valid_loss: 0.716898
validation finished
Epoch-23 lr: 4.5599448334722756e-07
epoch 23 training time: 18.667
---------------
2023-05-11 14:28:50.758034
current #epochs=24, #steps=1104
start validation
mAP: 0.128097
AUC: 0.613369
Avg Precision: 0.111533
Avg Recall: 1.000000
d_prime: 0.407451
train_loss: 0.130221
valid_loss: 0.716849
validation finished
Epoch-24 lr: 3.875953108451434e-07
epoch 24 training time: 18.908
---------------
2023-05-11 14:29:09.665860
current #epochs=25, #steps=1152
start validation
mAP: 0.128800
AUC: 0.612769
Avg Precision: 0.113134
Avg Recall: 1.000000
d_prime: 0.405234
train_loss: 0.128980
valid_loss: 0.716742
validation finished
Epoch-25 lr: 3.294560142183719e-07
epoch 25 training time: 18.594
---------------
2023-05-11 14:29:28.259963
current #epochs=26, #steps=1200
Epoch: [26][0/48]	Per Sample Total Time 0.02927	Per Sample Data Time 0.00535	Per Sample DNN Time 0.02392	Train Loss 0.1271	
start validation
mAP: 0.127966
AUC: 0.616974
Avg Precision: 0.111312
Avg Recall: 1.000000
d_prime: 0.420788
train_loss: 0.128583
valid_loss: 0.716680
validation finished
Epoch-26 lr: 2.800376120856161e-07
epoch 26 training time: 18.578
---------------
2023-05-11 14:29:46.839174
current #epochs=27, #steps=1248
start validation
mAP: 0.127852
AUC: 0.614069
Avg Precision: 0.111796
Avg Recall: 1.000000
d_prime: 0.410038
train_loss: 0.131842
valid_loss: 0.716676
validation finished
Epoch-27 lr: 2.380319702727737e-07
epoch 27 training time: 18.575
---------------
2023-05-11 14:30:05.413127
current #epochs=28, #steps=1296
Epoch: [28][4/48]	Per Sample Total Time 0.02873	Per Sample Data Time 0.00505	Per Sample DNN Time 0.02368	Train Loss 0.1291	
start validation
mAP: 0.129645
AUC: 0.616431
Avg Precision: 0.111616
Avg Recall: 1.000000
d_prime: 0.418778
train_loss: 0.131380
valid_loss: 0.716662
validation finished
Epoch-28 lr: 2.0232717473185765e-07
epoch 28 training time: 18.554
---------------
2023-05-11 14:30:23.967507
current #epochs=29, #steps=1344
start validation
mAP: 0.129429
AUC: 0.618356
Avg Precision: 0.112531
Avg Recall: 1.000000
d_prime: 0.425913
train_loss: 0.127956
valid_loss: 0.716637
validation finished
Epoch-29 lr: 1.71978098522079e-07
epoch 29 training time: 18.887
---------------
2023-05-11 14:30:42.854300
current #epochs=30, #steps=1392
Epoch: [30][8/48]	Per Sample Total Time 0.02872	Per Sample Data Time 0.00500	Per Sample DNN Time 0.02372	Train Loss 0.1281	
start validation
mAP: 0.127888
AUC: 0.617813
Avg Precision: 0.112438
Avg Recall: 1.000000
d_prime: 0.423900
train_loss: 0.129994
valid_loss: 0.716571
validation finished
Epoch-30 lr: 1.4618138374376713e-07
epoch 30 training time: 18.631
---------------Training Finished---------------
weighted averaged model results
mAP: 0.111970
AUC: 0.552173
Avg Precision: 0.096510
Avg Recall: 1.000000
d_prime: 0.185479
train_loss: 0.000000
valid_loss: 0.716571
---------------evaluate on the train, validation, test set---------------
now train a audio spectrogram transformer model
---------------AST Model Summary---------------
ImageNet pretraining: True, AudioSet pretraining: True
frequncey stride=10, time stride=10
number of patches=600
balanced sampler is being used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
(571, 88)
train auc:  0.7007269260994848
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
(68, 88)
val auc:  0.5643598226817755
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
(48, 88)
eval auc:  0.5589417986444412
I am process 39149, running on gpu38: starting (Thu May 11 14:31:24 2023)
args:  Namespace(data_train='./data/datafiles/train.json', data_val='./data/datafiles/eval.json', data_eval='./data/datafiles/test.json', label_csv='./data/class_labels_indices.csv', n_class=88, model='ast', dataset='audioset', exp_dir='./exp/ast-attempt2-audiosetmean', lr=1e-05, optim='adam', batch_size=12, num_workers=0, n_epochs=30, lr_patience=2, n_print_steps=100, save_model=True, freqm=24, timem=96, mixup=0.0, bal='bal', fstride=10, tstride=10, imagenet_pretrain=True, audioset_pretrain=True, dataset_mean=-4.2677393, dataset_std=4.5689974, audio_length=512, noise=False, metrics='mAP', loss='BCE', warmup=False, lrscheduler_start=5, lrscheduler_step=1, lrscheduler_decay=0.85, wa=True, wa_start=1, wa_end=5)
now train a audio spectrogram transformer model
balanced sampler is being used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -4.268 and std 4.569 to normalize the input.
number of classes is 88
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -4.268 and std 4.569 to normalize the input.
number of classes is 88
---------------AST Model Summary---------------
ImageNet pretraining: True, AudioSet pretraining: True
frequncey stride=10, time stride=10
number of patches=600

Creating experiment directory: ./exp/ast-attempt2-audiosetmean
Now starting training for 30 epochs
running on cuda
Total parameter number is : 87.324 million
Total trainable parameter number is : 87.324 million
now training with audioset, main metrics: mAP, loss function: BCEWithLogitsLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fd68e3eaa60>
The learning rate scheduler starts at 5 epoch with decay rate of 0.850 every 1 epochs
current #steps=0, #epochs=1
start training...
---------------
2023-05-11 14:31:27.750248
current #epochs=1, #steps=0
start validation
mAP: 0.101451
AUC: 0.556569
Avg Precision: 0.086191
Avg Recall: 1.000000
d_prime: 0.201208
train_loss: 0.308550
valid_loss: 0.764225
validation finished
Epoch-1 lr: 1e-05
epoch 1 training time: 30.703
---------------
2023-05-11 14:31:58.454669
current #epochs=2, #steps=48
start validation
mAP: 0.153625
AUC: 0.618856
Avg Precision: 0.119220
Avg Recall: 1.000000
d_prime: 0.427769
train_loss: 0.189121
valid_loss: 0.749048
validation finished
Epoch-2 lr: 1e-05
epoch 2 training time: 21.547
---------------
2023-05-11 14:32:20.000376
current #epochs=3, #steps=96
Epoch: [3][4/48]	Per Sample Total Time 0.02866	Per Sample Data Time 0.00499	Per Sample DNN Time 0.02367	Train Loss 0.1765	
start validation
mAP: 0.235212
AUC: 0.685482
Avg Precision: 0.195477
Avg Recall: 1.000000
d_prime: 0.683182
train_loss: 0.170696
valid_loss: 0.740260
validation finished
Epoch-3 lr: 1e-05
epoch 3 training time: 21.336
---------------
2023-05-11 14:32:41.336327
current #epochs=4, #steps=144
start validation
mAP: 0.274086
AUC: 0.732946
Avg Precision: 0.231778
Avg Recall: 1.000000
d_prime: 0.879284
train_loss: 0.157837
valid_loss: 0.733578
validation finished
Epoch-4 lr: 1e-05
epoch 4 training time: 21.860
---------------
2023-05-11 14:33:03.196938
current #epochs=5, #steps=192
Epoch: [5][8/48]	Per Sample Total Time 0.02880	Per Sample Data Time 0.00495	Per Sample DNN Time 0.02385	Train Loss 0.1519	
start validation
mAP: 0.299411
AUC: 0.774575
Avg Precision: 0.250126
Avg Recall: 1.000000
d_prime: 1.066317
train_loss: 0.147210
valid_loss: 0.729119
validation finished
Epoch-5 lr: 8.5e-06
epoch 5 training time: 21.399
---------------
2023-05-11 14:33:24.595929
current #epochs=6, #steps=240
start validation
mAP: 0.317977
AUC: 0.789074
Avg Precision: 0.263620
Avg Recall: 1.000000
d_prime: 1.135916
train_loss: 0.141709
valid_loss: 0.726157
validation finished
Epoch-6 lr: 7.2249999999999994e-06
epoch 6 training time: 21.751
---------------
2023-05-11 14:33:46.346662
current #epochs=7, #steps=288
Epoch: [7][12/48]	Per Sample Total Time 0.02847	Per Sample Data Time 0.00487	Per Sample DNN Time 0.02360	Train Loss 0.1386	
start validation
mAP: 0.330037
AUC: 0.800504
Avg Precision: 0.275738
Avg Recall: 1.000000
d_prime: 1.192778
train_loss: 0.136297
valid_loss: 0.724486
validation finished
Epoch-7 lr: 6.141249999999999e-06
epoch 7 training time: 21.074
---------------
2023-05-11 14:34:07.421065
current #epochs=8, #steps=336
start validation
mAP: 0.378546
AUC: 0.824242
Avg Precision: 0.307228
Avg Recall: 1.000000
d_prime: 1.317556
train_loss: 0.128860
valid_loss: 0.722515
validation finished
Epoch-8 lr: 5.220062499999999e-06
epoch 8 training time: 21.859
---------------
2023-05-11 14:34:29.280574
current #epochs=9, #steps=384
Epoch: [9][16/48]	Per Sample Total Time 0.02894	Per Sample Data Time 0.00495	Per Sample DNN Time 0.02399	Train Loss 0.1251	
start validation
mAP: 0.409187
AUC: 0.837068
Avg Precision: 0.334607
Avg Recall: 1.000000
d_prime: 1.389437
train_loss: 0.124379
valid_loss: 0.721582
validation finished
Epoch-9 lr: 4.4370531249999995e-06
epoch 9 training time: 21.298
---------------
2023-05-11 14:34:50.578414
current #epochs=10, #steps=432
start validation
mAP: 0.448172
AUC: 0.845261
Avg Precision: 0.349041
Avg Recall: 1.000000
d_prime: 1.437293
train_loss: 0.121761
valid_loss: 0.720991
validation finished
Epoch-10 lr: 3.7714951562499997e-06
epoch 10 training time: 21.356
---------------
2023-05-11 14:35:11.934611
current #epochs=11, #steps=480
Epoch: [11][20/48]	Per Sample Total Time 0.02933	Per Sample Data Time 0.00506	Per Sample DNN Time 0.02428	Train Loss 0.1182	
start validation
mAP: 0.476641
AUC: 0.855176
Avg Precision: 0.390694
Avg Recall: 1.000000
d_prime: 1.497500
train_loss: 0.118205
valid_loss: 0.720617
validation finished
Epoch-11 lr: 3.2057708828124997e-06
epoch 11 training time: 21.642
---------------
2023-05-11 14:35:33.575946
current #epochs=12, #steps=528
start validation
mAP: 0.501866
AUC: 0.856859
Avg Precision: 0.426741
Avg Recall: 1.000000
d_prime: 1.507993
train_loss: 0.114720
valid_loss: 0.720101
validation finished
Epoch-12 lr: 2.7249052503906246e-06
epoch 12 training time: 21.377
---------------
2023-05-11 14:35:54.954247
current #epochs=13, #steps=576
Epoch: [13][24/48]	Per Sample Total Time 0.02900	Per Sample Data Time 0.00495	Per Sample DNN Time 0.02405	Train Loss 0.1109	
start validation
mAP: 0.510025
AUC: 0.865640
Avg Precision: 0.445978
Avg Recall: 1.000000
d_prime: 1.564141
train_loss: 0.111263
valid_loss: 0.719420
validation finished
Epoch-13 lr: 2.316169462832031e-06
epoch 13 training time: 21.734
---------------
2023-05-11 14:36:16.687419
current #epochs=14, #steps=624
start validation
mAP: 0.523078
AUC: 0.871783
Avg Precision: 0.456136
Avg Recall: 1.000000
d_prime: 1.604932
train_loss: 0.108395
valid_loss: 0.718931
validation finished
Epoch-14 lr: 1.9687440434072264e-06
epoch 14 training time: 22.132
---------------
2023-05-11 14:36:38.821724
current #epochs=15, #steps=672
Epoch: [15][28/48]	Per Sample Total Time 0.02866	Per Sample Data Time 0.00497	Per Sample DNN Time 0.02370	Train Loss 0.1070	
start validation
mAP: 0.540664
AUC: 0.870712
Avg Precision: 0.474315
Avg Recall: 1.000000
d_prime: 1.597727
train_loss: 0.105845
valid_loss: 0.718403
validation finished
Epoch-15 lr: 1.6734324368961425e-06
epoch 15 training time: 21.374
---------------
2023-05-11 14:37:00.193953
current #epochs=16, #steps=720
start validation
mAP: 0.553943
AUC: 0.879767
Avg Precision: 0.486336
Avg Recall: 1.000000
d_prime: 1.660038
train_loss: 0.103642
valid_loss: 0.717945
validation finished
Epoch-16 lr: 1.422417571361721e-06
epoch 16 training time: 22.114
---------------
2023-05-11 14:37:22.309407
current #epochs=17, #steps=768
Epoch: [17][32/48]	Per Sample Total Time 0.02902	Per Sample Data Time 0.00494	Per Sample DNN Time 0.02408	Train Loss 0.1011	
start validation
mAP: 0.560340
AUC: 0.881200
Avg Precision: 0.495530
Avg Recall: 1.000000
d_prime: 1.670195
train_loss: 0.101667
valid_loss: 0.717874
validation finished
Epoch-17 lr: 1.2090549356574628e-06
epoch 17 training time: 21.921
---------------
2023-05-11 14:37:44.228772
current #epochs=18, #steps=816
start validation
mAP: 0.564685
AUC: 0.883309
Avg Precision: 0.500271
Avg Recall: 1.000000
d_prime: 1.685304
train_loss: 0.100389
valid_loss: 0.717348
validation finished
Epoch-18 lr: 1.0276966953088434e-06
epoch 18 training time: 21.601
---------------
2023-05-11 14:38:05.831228
current #epochs=19, #steps=864
Epoch: [19][36/48]	Per Sample Total Time 0.02877	Per Sample Data Time 0.00486	Per Sample DNN Time 0.02391	Train Loss 0.1001	
start validation
mAP: 0.572318
AUC: 0.882073
Avg Precision: 0.508778
Avg Recall: 1.000000
d_prime: 1.676427
train_loss: 0.099720
valid_loss: 0.717539
validation finished
Epoch-19 lr: 8.735421910125168e-07
epoch 19 training time: 22.404
---------------
2023-05-11 14:38:28.235669
current #epochs=20, #steps=912
start validation
mAP: 0.580230
AUC: 0.882645
Avg Precision: 0.518574
Avg Recall: 1.000000
d_prime: 1.680529
train_loss: 0.099241
valid_loss: 0.717153
validation finished
Epoch-20 lr: 7.425108623606393e-07
epoch 20 training time: 21.693
---------------
2023-05-11 14:38:49.928352
current #epochs=21, #steps=960
Epoch: [21][40/48]	Per Sample Total Time 0.02877	Per Sample Data Time 0.00496	Per Sample DNN Time 0.02381	Train Loss 0.0972	
start validation
mAP: 0.585480
AUC: 0.883789
Avg Precision: 0.521957
Avg Recall: 1.000000
d_prime: 1.688777
train_loss: 0.097281
valid_loss: 0.717064
validation finished
Epoch-21 lr: 6.311342330065434e-07
epoch 21 training time: 21.325
---------------
2023-05-11 14:39:11.253655
current #epochs=22, #steps=1008
start validation
mAP: 0.586940
AUC: 0.885987
Avg Precision: 0.521461
Avg Recall: 1.000000
d_prime: 1.704775
train_loss: 0.097162
valid_loss: 0.716923
validation finished
Epoch-22 lr: 5.364640980555618e-07
epoch 22 training time: 21.517
---------------
2023-05-11 14:39:32.770055
current #epochs=23, #steps=1056
Epoch: [23][44/48]	Per Sample Total Time 0.02876	Per Sample Data Time 0.00484	Per Sample DNN Time 0.02392	Train Loss 0.0970	
start validation
mAP: 0.589449
AUC: 0.885590
Avg Precision: 0.526437
Avg Recall: 1.000000
d_prime: 1.701870
train_loss: 0.096744
valid_loss: 0.716647
validation finished
Epoch-23 lr: 4.5599448334722756e-07
epoch 23 training time: 21.866
---------------
2023-05-11 14:39:54.635665
current #epochs=24, #steps=1104
start validation
mAP: 0.590398
AUC: 0.887007
Avg Precision: 0.527627
Avg Recall: 1.000000
d_prime: 1.712276
train_loss: 0.096655
valid_loss: 0.716694
validation finished
Epoch-24 lr: 3.875953108451434e-07
epoch 24 training time: 21.215
---------------
2023-05-11 14:40:15.850573
current #epochs=25, #steps=1152
start validation
mAP: 0.592827
AUC: 0.889047
Avg Precision: 0.525113
Avg Recall: 1.000000
d_prime: 1.727430
train_loss: 0.094190
valid_loss: 0.716534
validation finished
Epoch-25 lr: 3.294560142183719e-07
epoch 25 training time: 21.260
---------------
2023-05-11 14:40:37.112001
current #epochs=26, #steps=1200
Epoch: [26][0/48]	Per Sample Total Time 0.03091	Per Sample Data Time 0.00498	Per Sample DNN Time 0.02593	Train Loss 0.0993	
start validation
mAP: 0.591941
AUC: 0.888154
Avg Precision: 0.525765
Avg Recall: 1.000000
d_prime: 1.720772
train_loss: 0.095152
valid_loss: 0.716589
validation finished
Epoch-26 lr: 2.800376120856161e-07
epoch 26 training time: 18.577
---------------
2023-05-11 14:40:55.688848
current #epochs=27, #steps=1248
start validation
mAP: 0.591983
AUC: 0.889741
Avg Precision: 0.526400
Avg Recall: 1.000000
d_prime: 1.732630
train_loss: 0.096871
valid_loss: 0.716506
validation finished
Epoch-27 lr: 2.380319702727737e-07
epoch 27 training time: 18.478
---------------
2023-05-11 14:41:14.166963
current #epochs=28, #steps=1296
Epoch: [28][4/48]	Per Sample Total Time 0.02905	Per Sample Data Time 0.00443	Per Sample DNN Time 0.02462	Train Loss 0.0981	
start validation
mAP: 0.594856
AUC: 0.887961
Avg Precision: 0.528269
Avg Recall: 1.000000
d_prime: 1.719341
train_loss: 0.094990
valid_loss: 0.716359
validation finished
Epoch-28 lr: 2.0232717473185765e-07
epoch 28 training time: 21.250
---------------
2023-05-11 14:41:35.416967
current #epochs=29, #steps=1344
start validation
mAP: 0.597646
AUC: 0.888408
Avg Precision: 0.530885
Avg Recall: 1.000000
d_prime: 1.722659
train_loss: 0.095086
valid_loss: 0.716304
validation finished
Epoch-29 lr: 1.71978098522079e-07
epoch 29 training time: 21.231
---------------
2023-05-11 14:41:56.647957
current #epochs=30, #steps=1392
Epoch: [30][8/48]	Per Sample Total Time 0.02892	Per Sample Data Time 0.00514	Per Sample DNN Time 0.02378	Train Loss 0.0941	
start validation
mAP: 0.595104
AUC: 0.889299
Avg Precision: 0.528548
Avg Recall: 1.000000
d_prime: 1.729316
train_loss: 0.093950
valid_loss: 0.716277
validation finished
Epoch-30 lr: 1.4618138374376713e-07
epoch 30 training time: 18.563
---------------Training Finished---------------
weighted averaged model results
mAP: 0.238542
AUC: 0.692307
Avg Precision: 0.193854
Avg Recall: 1.000000
d_prime: 0.710502
train_loss: 0.000000
valid_loss: 0.716277
---------------evaluate on the train, validation, test set---------------
now train a audio spectrogram transformer model
---------------AST Model Summary---------------
ImageNet pretraining: True, AudioSet pretraining: True
frequncey stride=10, time stride=10
number of patches=600
balanced sampler is being used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -4.268 and std 4.569 to normalize the input.
number of classes is 88
(571, 88)
train auc:  0.9764297305621941
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -4.268 and std 4.569 to normalize the input.
number of classes is 88
(68, 88)
val auc:  0.8730924200794463
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -4.268 and std 4.569 to normalize the input.
number of classes is 88
(48, 88)
eval auc:  0.8757769734845504
I am process 5319, running on gpu38: starting (Thu May 11 14:42:34 2023)
args:  Namespace(data_train='./data/datafiles/train.json', data_val='./data/datafiles/eval.json', data_eval='./data/datafiles/test.json', label_csv='./data/class_labels_indices.csv', n_class=88, model='ast', dataset='audioset', exp_dir='./exp/ast-attempt3-largerbatch', lr=1e-05, optim='adam', batch_size=24, num_workers=0, n_epochs=30, lr_patience=2, n_print_steps=100, save_model=True, freqm=24, timem=96, mixup=0.0, bal='bal', fstride=10, tstride=10, imagenet_pretrain=True, audioset_pretrain=True, dataset_mean=-0.000321335, dataset_std=0.003499322, audio_length=512, noise=False, metrics='mAP', loss='BCE', warmup=False, lrscheduler_start=5, lrscheduler_step=1, lrscheduler_decay=0.85, wa=True, wa_start=1, wa_end=5)
now train a audio spectrogram transformer model
balanced sampler is being used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
---------------AST Model Summary---------------
ImageNet pretraining: True, AudioSet pretraining: True
frequncey stride=10, time stride=10
number of patches=600

Creating experiment directory: ./exp/ast-attempt3-largerbatch
Now starting training for 30 epochs
running on cuda
Total parameter number is : 87.324 million
Total trainable parameter number is : 87.324 million
now training with audioset, main metrics: mAP, loss function: BCEWithLogitsLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f2f0f37ca60>
The learning rate scheduler starts at 5 epoch with decay rate of 0.850 every 1 epochs
current #steps=0, #epochs=1
start training...
---------------
2023-05-11 14:42:38.170422
current #epochs=1, #steps=0
start validation
mAP: 0.062685
AUC: 0.495062
Avg Precision: 0.065728
Avg Recall: 1.000000
d_prime: -0.017504
train_loss: 0.497935
valid_loss: 0.824720
validation finished
Epoch-1 lr: 1e-05
epoch 1 training time: 27.259
---------------
2023-05-11 14:43:05.429782
current #epochs=2, #steps=24
start validation
mAP: 0.096807
AUC: 0.507674
Avg Precision: 0.078784
Avg Recall: 1.000000
d_prime: 0.027204
train_loss: 0.263415
valid_loss: 0.781598
validation finished
Epoch-2 lr: 1e-05
epoch 2 training time: 19.116
---------------
2023-05-11 14:43:24.546613
current #epochs=3, #steps=48
start validation
mAP: 0.086815
AUC: 0.499775
Avg Precision: 0.077226
Avg Recall: 1.000000
d_prime: -0.000799
train_loss: 0.214828
valid_loss: 0.767135
validation finished
Epoch-3 lr: 1e-05
epoch 3 training time: 15.477
---------------
2023-05-11 14:43:40.022919
current #epochs=4, #steps=72
start validation
mAP: 0.087984
AUC: 0.497858
Avg Precision: 0.077764
Avg Recall: 1.000000
d_prime: -0.007592
train_loss: 0.196020
valid_loss: 0.758674
validation finished
Epoch-4 lr: 1e-05
epoch 4 training time: 15.510
---------------
2023-05-11 14:43:55.534136
current #epochs=5, #steps=96
Epoch: [5][4/24]	Per Sample Total Time 0.02327	Per Sample Data Time 0.00473	Per Sample DNN Time 0.01853	Train Loss 0.1908	
start validation
mAP: 0.089572
AUC: 0.527303
Avg Precision: 0.078997
Avg Recall: 1.000000
d_prime: 0.096862
train_loss: 0.186806
valid_loss: 0.752238
validation finished
Epoch-5 lr: 8.5e-06
epoch 5 training time: 15.176
---------------
2023-05-11 14:44:10.709396
current #epochs=6, #steps=120
start validation
mAP: 0.093165
AUC: 0.538853
Avg Precision: 0.080247
Avg Recall: 1.000000
d_prime: 0.137947
train_loss: 0.178013
valid_loss: 0.747745
validation finished
Epoch-6 lr: 7.2249999999999994e-06
epoch 6 training time: 15.420
---------------
2023-05-11 14:44:26.129123
current #epochs=7, #steps=144
start validation
mAP: 0.097551
AUC: 0.536834
Avg Precision: 0.086062
Avg Recall: 1.000000
d_prime: 0.130758
train_loss: 0.170009
valid_loss: 0.744280
validation finished
Epoch-7 lr: 6.141249999999999e-06
epoch 7 training time: 19.593
---------------
2023-05-11 14:44:45.721894
current #epochs=8, #steps=168
start validation
mAP: 0.102102
AUC: 0.546118
Avg Precision: 0.087545
Avg Recall: 1.000000
d_prime: 0.163851
train_loss: 0.164378
valid_loss: 0.741713
validation finished
Epoch-8 lr: 5.220062499999999e-06
epoch 8 training time: 18.424
---------------
2023-05-11 14:45:04.146960
current #epochs=9, #steps=192
Epoch: [9][8/24]	Per Sample Total Time 0.02316	Per Sample Data Time 0.00460	Per Sample DNN Time 0.01855	Train Loss 0.1641	
start validation
mAP: 0.099036
AUC: 0.544791
Avg Precision: 0.083226
Avg Recall: 1.000000
d_prime: 0.159114
train_loss: 0.164658
valid_loss: 0.739879
validation finished
Epoch-9 lr: 4.4370531249999995e-06
epoch 9 training time: 15.807
---------------
2023-05-11 14:45:19.953843
current #epochs=10, #steps=216
start validation
mAP: 0.099644
AUC: 0.552002
Avg Precision: 0.083533
Avg Recall: 1.000000
d_prime: 0.184867
train_loss: 0.158318
valid_loss: 0.738290
validation finished
Epoch-10 lr: 3.7714951562499997e-06
epoch 10 training time: 15.602
---------------
2023-05-11 14:45:35.554555
current #epochs=11, #steps=240
start validation
mAP: 0.101947
AUC: 0.549523
Avg Precision: 0.084541
Avg Recall: 1.000000
d_prime: 0.176009
train_loss: 0.157158
valid_loss: 0.736810
validation finished
Epoch-11 lr: 3.2057708828124997e-06
epoch 11 training time: 15.614
---------------
2023-05-11 14:45:51.169343
current #epochs=12, #steps=264
start validation
mAP: 0.101347
AUC: 0.547727
Avg Precision: 0.085650
Avg Recall: 1.000000
d_prime: 0.169594
train_loss: 0.152989
valid_loss: 0.735828
validation finished
Epoch-12 lr: 2.7249052503906246e-06
epoch 12 training time: 15.338
---------------
2023-05-11 14:46:06.507196
current #epochs=13, #steps=288
Epoch: [13][12/24]	Per Sample Total Time 0.02344	Per Sample Data Time 0.00480	Per Sample DNN Time 0.01864	Train Loss 0.1556	
start validation
mAP: 0.102514
AUC: 0.551274
Avg Precision: 0.084236
Avg Recall: 1.000000
d_prime: 0.182264
train_loss: 0.154430
valid_loss: 0.735052
validation finished
Epoch-13 lr: 2.316169462832031e-06
epoch 13 training time: 18.545
---------------
2023-05-11 14:46:25.051565
current #epochs=14, #steps=312
start validation
mAP: 0.100258
AUC: 0.550378
Avg Precision: 0.084722
Avg Recall: 1.000000
d_prime: 0.179064
train_loss: 0.154779
valid_loss: 0.734349
validation finished
Epoch-14 lr: 1.9687440434072264e-06
epoch 14 training time: 15.315
---------------
2023-05-11 14:46:40.366883
current #epochs=15, #steps=336
start validation
mAP: 0.107366
AUC: 0.548355
Avg Precision: 0.090113
Avg Recall: 1.000000
d_prime: 0.171836
train_loss: 0.150260
valid_loss: 0.733687
validation finished
Epoch-15 lr: 1.6734324368961425e-06
epoch 15 training time: 18.201
---------------
2023-05-11 14:46:58.567658
current #epochs=16, #steps=360
start validation
mAP: 0.099476
AUC: 0.547024
Avg Precision: 0.083771
Avg Recall: 1.000000
d_prime: 0.167085
train_loss: 0.151662
valid_loss: 0.733171
validation finished
Epoch-16 lr: 1.422417571361721e-06
epoch 16 training time: 15.511
---------------
2023-05-11 14:47:14.078575
current #epochs=17, #steps=384
Epoch: [17][16/24]	Per Sample Total Time 0.02348	Per Sample Data Time 0.00484	Per Sample DNN Time 0.01864	Train Loss 0.1504	
start validation
mAP: 0.101686
AUC: 0.541958
Avg Precision: 0.084168
Avg Recall: 1.000000
d_prime: 0.149012
train_loss: 0.150241
valid_loss: 0.732780
validation finished
Epoch-17 lr: 1.2090549356574628e-06
epoch 17 training time: 15.400
---------------
2023-05-11 14:47:29.478942
current #epochs=18, #steps=408
start validation
mAP: 0.100213
AUC: 0.545392
Avg Precision: 0.086134
Avg Recall: 1.000000
d_prime: 0.161260
train_loss: 0.149632
valid_loss: 0.732419
validation finished
Epoch-18 lr: 1.0276966953088434e-06
epoch 18 training time: 15.250
---------------
2023-05-11 14:47:44.729619
current #epochs=19, #steps=432
start validation
mAP: 0.101008
AUC: 0.547079
Avg Precision: 0.084771
Avg Recall: 1.000000
d_prime: 0.167279
train_loss: 0.148649
valid_loss: 0.732078
validation finished
Epoch-19 lr: 8.735421910125168e-07
epoch 19 training time: 16.221
---------------
2023-05-11 14:48:00.951005
current #epochs=20, #steps=456
start validation
mAP: 0.104726
AUC: 0.546717
Avg Precision: 0.085829
Avg Recall: 1.000000
d_prime: 0.165988
train_loss: 0.148311
valid_loss: 0.731803
validation finished
Epoch-20 lr: 7.425108623606393e-07
epoch 20 training time: 15.421
---------------
2023-05-11 14:48:16.371711
current #epochs=21, #steps=480
Epoch: [21][20/24]	Per Sample Total Time 0.02371	Per Sample Data Time 0.00481	Per Sample DNN Time 0.01890	Train Loss 0.1492	
start validation
mAP: 0.102405
AUC: 0.545632
Avg Precision: 0.084373
Avg Recall: 1.000000
d_prime: 0.162117
train_loss: 0.148800
valid_loss: 0.731584
validation finished
Epoch-21 lr: 6.311342330065434e-07
epoch 21 training time: 15.548
---------------
2023-05-11 14:48:31.920158
current #epochs=22, #steps=504
start validation
mAP: 0.102767
AUC: 0.542528
Avg Precision: 0.084980
Avg Recall: 1.000000
d_prime: 0.151044
train_loss: 0.149384
valid_loss: 0.731419
validation finished
Epoch-22 lr: 5.364640980555618e-07
epoch 22 training time: 15.652
---------------
2023-05-11 14:48:47.572044
current #epochs=23, #steps=528
start validation
mAP: 0.102141
AUC: 0.546743
Avg Precision: 0.085297
Avg Recall: 1.000000
d_prime: 0.166081
train_loss: 0.149138
valid_loss: 0.731297
validation finished
Epoch-23 lr: 4.5599448334722756e-07
epoch 23 training time: 15.582
---------------
2023-05-11 14:49:03.154916
current #epochs=24, #steps=552
start validation
mAP: 0.106851
AUC: 0.547940
Avg Precision: 0.089289
Avg Recall: 1.000000
d_prime: 0.170352
train_loss: 0.149360
valid_loss: 0.731197
validation finished
Epoch-24 lr: 3.875953108451434e-07
epoch 24 training time: 15.958
---------------
2023-05-11 14:49:19.112546
current #epochs=25, #steps=576
start validation
mAP: 0.103307
AUC: 0.547831
Avg Precision: 0.087352
Avg Recall: 1.000000
d_prime: 0.169966
train_loss: 0.147774
valid_loss: 0.731092
validation finished
Epoch-25 lr: 3.294560142183719e-07
epoch 25 training time: 15.594
---------------
2023-05-11 14:49:34.706599
current #epochs=26, #steps=600
Epoch: [26][0/24]	Per Sample Total Time 0.02377	Per Sample Data Time 0.00503	Per Sample DNN Time 0.01874	Train Loss 0.1458	
start validation
mAP: 0.104941
AUC: 0.546962
Avg Precision: 0.086758
Avg Recall: 1.000000
d_prime: 0.166862
train_loss: 0.146521
valid_loss: 0.730982
validation finished
Epoch-26 lr: 2.800376120856161e-07
epoch 26 training time: 15.529
---------------
2023-05-11 14:49:50.234382
current #epochs=27, #steps=624
start validation
mAP: 0.102040
AUC: 0.545752
Avg Precision: 0.085947
Avg Recall: 1.000000
d_prime: 0.162543
train_loss: 0.147325
valid_loss: 0.730879
validation finished
Epoch-27 lr: 2.380319702727737e-07
epoch 27 training time: 16.203
---------------
2023-05-11 14:50:06.437558
current #epochs=28, #steps=648
start validation
mAP: 0.101402
AUC: 0.546897
Avg Precision: 0.086393
Avg Recall: 1.000000
d_prime: 0.166631
train_loss: 0.148882
valid_loss: 0.730800
validation finished
Epoch-28 lr: 2.0232717473185765e-07
epoch 28 training time: 15.504
---------------
2023-05-11 14:50:21.942906
current #epochs=29, #steps=672
start validation
mAP: 0.105624
AUC: 0.546137
Avg Precision: 0.088239
Avg Recall: 1.000000
d_prime: 0.163917
train_loss: 0.145599
valid_loss: 0.730733
validation finished
Epoch-29 lr: 1.71978098522079e-07
epoch 29 training time: 15.432
---------------
2023-05-11 14:50:37.374934
current #epochs=30, #steps=696
Epoch: [30][4/24]	Per Sample Total Time 0.02342	Per Sample Data Time 0.00486	Per Sample DNN Time 0.01856	Train Loss 0.1512	
start validation
mAP: 0.102169
AUC: 0.545991
Avg Precision: 0.084231
Avg Recall: 1.000000
d_prime: 0.163396
train_loss: 0.147726
valid_loss: 0.730680
validation finished
Epoch-30 lr: 1.4618138374376713e-07
epoch 30 training time: 16.408
---------------Training Finished---------------
weighted averaged model results
mAP: 0.093908
AUC: 0.500998
Avg Precision: 0.079067
Avg Recall: 1.000000
d_prime: 0.003538
train_loss: 0.000000
valid_loss: 0.730680
---------------evaluate on the train, validation, test set---------------
now train a audio spectrogram transformer model
---------------AST Model Summary---------------
ImageNet pretraining: True, AudioSet pretraining: True
frequncey stride=10, time stride=10
number of patches=600
balanced sampler is being used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
(571, 88)
train auc:  0.6248804039192579
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
(68, 88)
val auc:  0.5311268811610225
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
(48, 88)
eval auc:  0.5379944248991199
I am process 9135, running on gpu38: starting (Thu May 11 14:51:14 2023)
args:  Namespace(data_train='./data/datafiles/train.json', data_val='./data/datafiles/eval.json', data_eval='./data/datafiles/test.json', label_csv='./data/class_labels_indices.csv', n_class=88, model='ast', dataset='audioset', exp_dir='./exp/ast-attempt4-largerstride', lr=1e-05, optim='adam', batch_size=12, num_workers=0, n_epochs=30, lr_patience=2, n_print_steps=100, save_model=True, freqm=24, timem=96, mixup=0.0, bal='bal', fstride=16, tstride=16, imagenet_pretrain=True, audioset_pretrain=True, dataset_mean=-0.000321335, dataset_std=0.003499322, audio_length=512, noise=False, metrics='mAP', loss='BCE', warmup=False, lrscheduler_start=5, lrscheduler_step=1, lrscheduler_decay=0.85, wa=True, wa_start=1, wa_end=5)
now train a audio spectrogram transformer model
balanced sampler is being used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
---------------AST Model Summary---------------
ImageNet pretraining: True, AudioSet pretraining: True
frequncey stride=16, time stride=16
number of patches=256

Creating experiment directory: ./exp/ast-attempt4-largerstride
Now starting training for 30 epochs
running on cuda
Total parameter number is : 87.060 million
Total trainable parameter number is : 87.060 million
now training with audioset, main metrics: mAP, loss function: BCEWithLogitsLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f1f337c60a0>
The learning rate scheduler starts at 5 epoch with decay rate of 0.850 every 1 epochs
current #steps=0, #epochs=1
start training...
---------------
2023-05-11 14:51:17.398237
current #epochs=1, #steps=0
Traceback (most recent call last):
  File "/research/dept8/fyp22/lj2202/eleg5491/ast/egs/kaggle/../../src/run.py", line 145, in <module>
    train(audio_model, train_loader, val_loader, args)
  File "/research/dept8/fyp22/lj2202/eleg5491/ast/src/traintest.py", line 127, in train
    audio_output = audio_model(audio_input)
  File "/research/dept8/fyp22/lj2202/anaconda3/envs/eleg5491/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/research/dept8/fyp22/lj2202/anaconda3/envs/eleg5491/lib/python3.9/site-packages/torch/nn/parallel/data_parallel.py", line 171, in forward
    outputs = self.parallel_apply(replicas, inputs, kwargs)
  File "/research/dept8/fyp22/lj2202/anaconda3/envs/eleg5491/lib/python3.9/site-packages/torch/nn/parallel/data_parallel.py", line 181, in parallel_apply
    return parallel_apply(replicas, inputs, kwargs, self.device_ids[:len(replicas)])
  File "/research/dept8/fyp22/lj2202/anaconda3/envs/eleg5491/lib/python3.9/site-packages/torch/nn/parallel/parallel_apply.py", line 89, in parallel_apply
    output.reraise()
  File "/research/dept8/fyp22/lj2202/anaconda3/envs/eleg5491/lib/python3.9/site-packages/torch/_utils.py", line 644, in reraise
    raise exception
RuntimeError: Caught RuntimeError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/research/dept8/fyp22/lj2202/anaconda3/envs/eleg5491/lib/python3.9/site-packages/torch/nn/parallel/parallel_apply.py", line 64, in _worker
    output = module(*input, **kwargs)
  File "/research/dept8/fyp22/lj2202/anaconda3/envs/eleg5491/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/research/dept8/fyp22/lj2202/anaconda3/envs/eleg5491/lib/python3.9/site-packages/torch/amp/autocast_mode.py", line 14, in decorate_autocast
    return func(*args, **kwargs)
  File "/research/dept8/fyp22/lj2202/eleg5491/ast/src/models/ast_models.py", line 179, in forward
    x = x + self.v.pos_embed
RuntimeError: The size of tensor a (602) must match the size of tensor b (258) at non-singleton dimension 1

I am process 9190, running on gpu38: starting (Thu May 11 14:51:27 2023)
args:  Namespace(data_train='./data/datafiles/train.json', data_val='./data/datafiles/eval.json', data_eval='./data/datafiles/test.json', label_csv='./data/class_labels_indices.csv', n_class=88, model='ast', dataset='audioset', exp_dir='./exp/ast-attempt5-nopretrain', lr=1e-05, optim='adam', batch_size=12, num_workers=0, n_epochs=30, lr_patience=2, n_print_steps=100, save_model=True, freqm=24, timem=96, mixup=0.0, bal='bal', fstride=10, tstride=10, imagenet_pretrain=False, audioset_pretrain=False, dataset_mean=-0.000321335, dataset_std=0.003499322, audio_length=512, noise=False, metrics='mAP', loss='BCE', warmup=False, lrscheduler_start=5, lrscheduler_step=1, lrscheduler_decay=0.85, wa=True, wa_start=1, wa_end=5)
now train a audio spectrogram transformer model
balanced sampler is being used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
---------------AST Model Summary---------------
ImageNet pretraining: False, AudioSet pretraining: False
frequncey stride=10, time stride=10
number of patches=600

Creating experiment directory: ./exp/ast-attempt5-nopretrain
Now starting training for 30 epochs
running on cuda
Total parameter number is : 87.324 million
Total trainable parameter number is : 87.324 million
now training with audioset, main metrics: mAP, loss function: BCEWithLogitsLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f55540d7640>
The learning rate scheduler starts at 5 epoch with decay rate of 0.850 every 1 epochs
current #steps=0, #epochs=1
start training...
---------------
2023-05-11 14:51:31.024129
current #epochs=1, #steps=0
start validation
mAP: 0.097059
AUC: 0.584217
Avg Precision: 0.088303
Avg Recall: 1.000000
d_prime: 0.300793
train_loss: 0.277096
valid_loss: 0.764891
validation finished
Epoch-1 lr: 1e-05
epoch 1 training time: 30.176
---------------
2023-05-11 14:52:01.200534
current #epochs=2, #steps=48
start validation
mAP: 0.095485
AUC: 0.559799
Avg Precision: 0.087315
Avg Recall: 1.000000
d_prime: 0.212782
train_loss: 0.193289
valid_loss: 0.752161
validation finished
Epoch-2 lr: 1e-05
epoch 2 training time: 18.521
---------------
2023-05-11 14:52:19.722881
current #epochs=3, #steps=96
Epoch: [3][4/48]	Per Sample Total Time 0.02877	Per Sample Data Time 0.00492	Per Sample DNN Time 0.02384	Train Loss 0.1860	
start validation
mAP: 0.090015
AUC: 0.553361
Avg Precision: 0.079563
Avg Recall: 1.000000
d_prime: 0.189729
train_loss: 0.175944
valid_loss: 0.742807
validation finished
Epoch-3 lr: 1e-05
epoch 3 training time: 18.491
---------------
2023-05-11 14:52:38.213679
current #epochs=4, #steps=144
start validation
mAP: 0.083422
AUC: 0.531778
Avg Precision: 0.075688
Avg Recall: 1.000000
d_prime: 0.112771
train_loss: 0.160595
valid_loss: 0.735503
validation finished
Epoch-4 lr: 1e-05
epoch 4 training time: 18.474
---------------
2023-05-11 14:52:56.687626
current #epochs=5, #steps=192
Epoch: [5][8/48]	Per Sample Total Time 0.02887	Per Sample Data Time 0.00507	Per Sample DNN Time 0.02379	Train Loss 0.1585	
start validation
mAP: 0.089613
AUC: 0.552815
Avg Precision: 0.080569
Avg Recall: 1.000000
d_prime: 0.187773
train_loss: 0.152333
valid_loss: 0.729886
validation finished
Epoch-5 lr: 8.5e-06
epoch 5 training time: 18.545
---------------
2023-05-11 14:53:15.232713
current #epochs=6, #steps=240
start validation
mAP: 0.090942
AUC: 0.564867
Avg Precision: 0.081154
Avg Recall: 1.000000
d_prime: 0.230970
train_loss: 0.140946
valid_loss: 0.725752
validation finished
Epoch-6 lr: 7.2249999999999994e-06
epoch 6 training time: 18.470
---------------
2023-05-11 14:53:33.702145
current #epochs=7, #steps=288
Epoch: [7][12/48]	Per Sample Total Time 0.02870	Per Sample Data Time 0.00490	Per Sample DNN Time 0.02380	Train Loss 0.1420	
start validation
mAP: 0.101130
AUC: 0.558183
Avg Precision: 0.090475
Avg Recall: 1.000000
d_prime: 0.206991
train_loss: 0.139961
valid_loss: 0.724181
validation finished
Epoch-7 lr: 6.141249999999999e-06
epoch 7 training time: 30.229
---------------
2023-05-11 14:54:03.930636
current #epochs=8, #steps=336
start validation
mAP: 0.108177
AUC: 0.582103
Avg Precision: 0.097453
Avg Recall: 1.000000
d_prime: 0.293132
train_loss: 0.136273
valid_loss: 0.721681
validation finished
Epoch-8 lr: 5.220062499999999e-06
epoch 8 training time: 23.758
---------------
2023-05-11 14:54:27.689620
current #epochs=9, #steps=384
Epoch: [9][16/48]	Per Sample Total Time 0.02852	Per Sample Data Time 0.00483	Per Sample DNN Time 0.02369	Train Loss 0.1375	
start validation
mAP: 0.120277
AUC: 0.587945
Avg Precision: 0.108031
Avg Recall: 1.000000
d_prime: 0.314327
train_loss: 0.134822
valid_loss: 0.720688
validation finished
Epoch-9 lr: 4.4370531249999995e-06
epoch 9 training time: 21.245
---------------
2023-05-11 14:54:48.935010
current #epochs=10, #steps=432
start validation
mAP: 0.098095
AUC: 0.585262
Avg Precision: 0.086979
Avg Recall: 1.000000
d_prime: 0.304585
train_loss: 0.133116
valid_loss: 0.719804
validation finished
Epoch-10 lr: 3.7714951562499997e-06
epoch 10 training time: 18.442
---------------
2023-05-11 14:55:07.377801
current #epochs=11, #steps=480
Epoch: [11][20/48]	Per Sample Total Time 0.02855	Per Sample Data Time 0.00484	Per Sample DNN Time 0.02371	Train Loss 0.1334	
start validation
mAP: 0.098916
AUC: 0.600102
Avg Precision: 0.089694
Avg Recall: 1.000000
d_prime: 0.358659
train_loss: 0.133082
valid_loss: 0.718902
validation finished
Epoch-11 lr: 3.2057708828124997e-06
epoch 11 training time: 18.397
---------------
2023-05-11 14:55:25.774970
current #epochs=12, #steps=528
start validation
mAP: 0.097453
AUC: 0.606426
Avg Precision: 0.088145
Avg Recall: 1.000000
d_prime: 0.381859
train_loss: 0.132442
valid_loss: 0.718043
validation finished
Epoch-12 lr: 2.7249052503906246e-06
epoch 12 training time: 18.660
---------------
2023-05-11 14:55:44.433708
current #epochs=13, #steps=576
Epoch: [13][24/48]	Per Sample Total Time 0.02846	Per Sample Data Time 0.00480	Per Sample DNN Time 0.02367	Train Loss 0.1291	
start validation
mAP: 0.093238
AUC: 0.591256
Avg Precision: 0.083509
Avg Recall: 1.000000
d_prime: 0.326370
train_loss: 0.129688
valid_loss: 0.717488
validation finished
Epoch-13 lr: 2.316169462832031e-06
epoch 13 training time: 18.399
---------------
2023-05-11 14:56:02.833927
current #epochs=14, #steps=624
start validation
mAP: 0.095965
AUC: 0.601369
Avg Precision: 0.085972
Avg Recall: 1.000000
d_prime: 0.363299
train_loss: 0.130107
valid_loss: 0.717120
validation finished
Epoch-14 lr: 1.9687440434072264e-06
epoch 14 training time: 18.480
---------------
2023-05-11 14:56:21.312513
current #epochs=15, #steps=672
Epoch: [15][28/48]	Per Sample Total Time 0.02849	Per Sample Data Time 0.00482	Per Sample DNN Time 0.02367	Train Loss 0.1281	
start validation
mAP: 0.087600
AUC: 0.600318
Avg Precision: 0.076940
Avg Recall: 1.000000
d_prime: 0.359451
train_loss: 0.128497
valid_loss: 0.716858
validation finished
Epoch-15 lr: 1.6734324368961425e-06
epoch 15 training time: 18.369
---------------
2023-05-11 14:56:39.682447
current #epochs=16, #steps=720
start validation
mAP: 0.094458
AUC: 0.594681
Avg Precision: 0.081550
Avg Recall: 1.000000
d_prime: 0.338849
train_loss: 0.130558
valid_loss: 0.716779
validation finished
Epoch-16 lr: 1.422417571361721e-06
epoch 16 training time: 18.633
---------------
2023-05-11 14:56:58.315433
current #epochs=17, #steps=768
Epoch: [17][32/48]	Per Sample Total Time 0.02864	Per Sample Data Time 0.00493	Per Sample DNN Time 0.02371	Train Loss 0.1296	
start validation
mAP: 0.090541
AUC: 0.605429
Avg Precision: 0.077040
Avg Recall: 1.000000
d_prime: 0.378198
train_loss: 0.130057
valid_loss: 0.716490
validation finished
Epoch-17 lr: 1.2090549356574628e-06
epoch 17 training time: 18.393
---------------
2023-05-11 14:57:16.708613
current #epochs=18, #steps=816
start validation
mAP: 0.089157
AUC: 0.608300
Avg Precision: 0.078439
Avg Recall: 1.000000
d_prime: 0.388756
train_loss: 0.126743
valid_loss: 0.716217
validation finished
Epoch-18 lr: 1.0276966953088434e-06
epoch 18 training time: 18.352
---------------
2023-05-11 14:57:35.060670
current #epochs=19, #steps=864
Epoch: [19][36/48]	Per Sample Total Time 0.02855	Per Sample Data Time 0.00485	Per Sample DNN Time 0.02370	Train Loss 0.1274	
start validation
mAP: 0.093153
AUC: 0.619254
Avg Precision: 0.081248
Avg Recall: 1.000000
d_prime: 0.429244
train_loss: 0.126993
valid_loss: 0.716186
validation finished
Epoch-19 lr: 8.735421910125168e-07
epoch 19 training time: 18.362
---------------
2023-05-11 14:57:53.422180
current #epochs=20, #steps=912
start validation
mAP: 0.091831
AUC: 0.602038
Avg Precision: 0.080287
Avg Recall: 1.000000
d_prime: 0.365753
train_loss: 0.130162
valid_loss: 0.716151
validation finished
Epoch-20 lr: 7.425108623606393e-07
epoch 20 training time: 18.450
---------------
2023-05-11 14:58:11.871791
current #epochs=21, #steps=960
Epoch: [21][40/48]	Per Sample Total Time 0.02861	Per Sample Data Time 0.00489	Per Sample DNN Time 0.02372	Train Loss 0.1293	
start validation
mAP: 0.098481
AUC: 0.626975
Avg Precision: 0.087153
Avg Recall: 1.000000
d_prime: 0.457998
train_loss: 0.128746
valid_loss: 0.715897
validation finished
Epoch-21 lr: 6.311342330065434e-07
epoch 21 training time: 18.632
---------------
2023-05-11 14:58:30.504527
current #epochs=22, #steps=1008
start validation
mAP: 0.095192
AUC: 0.604618
Avg Precision: 0.081160
Avg Recall: 1.000000
d_prime: 0.375218
train_loss: 0.127370
valid_loss: 0.715736
validation finished
Epoch-22 lr: 5.364640980555618e-07
epoch 22 training time: 18.479
---------------
2023-05-11 14:58:48.983010
current #epochs=23, #steps=1056
Epoch: [23][44/48]	Per Sample Total Time 0.02846	Per Sample Data Time 0.00480	Per Sample DNN Time 0.02366	Train Loss 0.1264	
start validation
mAP: 0.096400
AUC: 0.614038
Avg Precision: 0.083112
Avg Recall: 1.000000
d_prime: 0.409923
train_loss: 0.126772
valid_loss: 0.715661
validation finished
Epoch-23 lr: 4.5599448334722756e-07
epoch 23 training time: 18.329
---------------
2023-05-11 14:59:07.312111
current #epochs=24, #steps=1104
start validation
mAP: 0.096554
AUC: 0.616269
Avg Precision: 0.081020
Avg Recall: 1.000000
d_prime: 0.418177
train_loss: 0.125230
valid_loss: 0.715416
validation finished
Epoch-24 lr: 3.875953108451434e-07
epoch 24 training time: 22.087
---------------
2023-05-11 14:59:29.399132
current #epochs=25, #steps=1152
start validation
mAP: 0.094029
AUC: 0.597709
Avg Precision: 0.078335
Avg Recall: 1.000000
d_prime: 0.349905
train_loss: 0.126565
valid_loss: 0.715419
validation finished
Epoch-25 lr: 3.294560142183719e-07
epoch 25 training time: 18.743
---------------
2023-05-11 14:59:48.142547
current #epochs=26, #steps=1200
Epoch: [26][0/48]	Per Sample Total Time 0.02871	Per Sample Data Time 0.00504	Per Sample DNN Time 0.02367	Train Loss 0.1359	
start validation
mAP: 0.099667
AUC: 0.612892
Avg Precision: 0.082676
Avg Recall: 1.000000
d_prime: 0.405686
train_loss: 0.128899
valid_loss: 0.715409
validation finished
Epoch-26 lr: 2.800376120856161e-07
epoch 26 training time: 18.452
---------------
2023-05-11 15:00:06.593994
current #epochs=27, #steps=1248
start validation
mAP: 0.102483
AUC: 0.606856
Avg Precision: 0.087405
Avg Recall: 1.000000
d_prime: 0.383441
train_loss: 0.129462
valid_loss: 0.715427
validation finished
Epoch-27 lr: 2.380319702727737e-07
epoch 27 training time: 18.536
---------------
2023-05-11 15:00:25.130211
current #epochs=28, #steps=1296
Epoch: [28][4/48]	Per Sample Total Time 0.02849	Per Sample Data Time 0.00474	Per Sample DNN Time 0.02375	Train Loss 0.1249	
start validation
mAP: 0.103545
AUC: 0.625122
Avg Precision: 0.085812
Avg Recall: 1.000000
d_prime: 0.451080
train_loss: 0.125517
valid_loss: 0.715357
validation finished
Epoch-28 lr: 2.0232717473185765e-07
epoch 28 training time: 18.657
---------------
2023-05-11 15:00:43.788163
current #epochs=29, #steps=1344
start validation
mAP: 0.091882
AUC: 0.605136
Avg Precision: 0.076461
Avg Recall: 1.000000
d_prime: 0.377118
train_loss: 0.128102
valid_loss: 0.715342
validation finished
Epoch-29 lr: 1.71978098522079e-07
epoch 29 training time: 19.514
---------------
2023-05-11 15:01:03.301835
current #epochs=30, #steps=1392
Epoch: [30][8/48]	Per Sample Total Time 0.02879	Per Sample Data Time 0.00501	Per Sample DNN Time 0.02379	Train Loss 0.1288	
start validation
mAP: 0.105009
AUC: 0.627680
Avg Precision: 0.089030
Avg Recall: 1.000000
d_prime: 0.460629
train_loss: 0.126876
valid_loss: 0.715299
validation finished
Epoch-30 lr: 1.4618138374376713e-07
epoch 30 training time: 18.436
---------------Training Finished---------------
weighted averaged model results
mAP: 0.087980
AUC: 0.557009
Avg Precision: 0.079445
Avg Recall: 1.000000
d_prime: 0.202785
train_loss: 0.000000
valid_loss: 0.715299
---------------evaluate on the train, validation, test set---------------
now train a audio spectrogram transformer model
---------------AST Model Summary---------------
ImageNet pretraining: False, AudioSet pretraining: False
frequncey stride=10, time stride=10
number of patches=600
balanced sampler is being used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
(571, 88)
train auc:  0.6983945988810558
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
(68, 88)
val auc:  0.5704293951562645
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
(48, 88)
eval auc:  0.5697266964155249
I am process 15811, running on gpu38: starting (Thu May 11 15:01:59 2023)
args:  Namespace(data_train='./data/datafiles/train.json', data_val='./data/datafiles/eval.json', data_eval='./data/datafiles/test.json', label_csv='./data/class_labels_indices.csv', n_class=88, model='ast', dataset='audioset', exp_dir='./exp/ast-attempt6-noweight', lr=1e-05, optim='adam', batch_size=12, num_workers=0, n_epochs=30, lr_patience=2, n_print_steps=100, save_model=True, freqm=24, timem=96, mixup=0.0, bal='bal', fstride=10, tstride=10, imagenet_pretrain=True, audioset_pretrain=True, dataset_mean=-0.000321335, dataset_std=0.003499322, audio_length=512, noise=False, metrics='mAP', loss='BCE', warmup=False, lrscheduler_start=5, lrscheduler_step=1, lrscheduler_decay=0.85, wa=False, wa_start=1, wa_end=5)
now train a audio spectrogram transformer model
balanced sampler is being used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
---------------AST Model Summary---------------
ImageNet pretraining: True, AudioSet pretraining: True
frequncey stride=10, time stride=10
number of patches=600

Creating experiment directory: ./exp/ast-attempt6-noweight
Now starting training for 30 epochs
running on cuda
Total parameter number is : 87.324 million
Total trainable parameter number is : 87.324 million
now training with audioset, main metrics: mAP, loss function: BCEWithLogitsLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f1eccc575b0>
The learning rate scheduler starts at 5 epoch with decay rate of 0.850 every 1 epochs
current #steps=0, #epochs=1
start training...
---------------
2023-05-11 15:02:02.644921
current #epochs=1, #steps=0
start validation
mAP: 0.070295
AUC: 0.505895
Avg Precision: 0.058749
Avg Recall: 1.000000
d_prime: 0.020898
train_loss: 0.355240
valid_loss: 0.777439
validation finished
Epoch-1 lr: 1e-05
epoch 1 training time: 30.732
---------------
2023-05-11 15:02:33.377474
current #epochs=2, #steps=48
start validation
mAP: 0.083998
AUC: 0.522468
Avg Precision: 0.076530
Avg Recall: 1.000000
d_prime: 0.079688
train_loss: 0.202013
valid_loss: 0.756454
validation finished
Epoch-2 lr: 1e-05
epoch 2 training time: 21.905
---------------
2023-05-11 15:02:55.282908
current #epochs=3, #steps=96
Epoch: [3][4/48]	Per Sample Total Time 0.02909	Per Sample Data Time 0.00498	Per Sample DNN Time 0.02411	Train Loss 0.1838	
start validation
mAP: 0.084406
AUC: 0.521485
Avg Precision: 0.075871
Avg Recall: 1.000000
d_prime: 0.076198
train_loss: 0.176927
valid_loss: 0.745517
validation finished
Epoch-3 lr: 1e-05
epoch 3 training time: 21.241
---------------
2023-05-11 15:03:16.523899
current #epochs=4, #steps=144
start validation
mAP: 0.098012
AUC: 0.543437
Avg Precision: 0.091110
Avg Recall: 1.000000
d_prime: 0.154286
train_loss: 0.164991
valid_loss: 0.738291
validation finished
Epoch-4 lr: 1e-05
epoch 4 training time: 21.409
---------------
2023-05-11 15:03:37.933275
current #epochs=5, #steps=192
Epoch: [5][8/48]	Per Sample Total Time 0.02886	Per Sample Data Time 0.00529	Per Sample DNN Time 0.02357	Train Loss 0.1590	
start validation
mAP: 0.101352
AUC: 0.569084
Avg Precision: 0.096317
Avg Recall: 1.000000
d_prime: 0.246134
train_loss: 0.155375
valid_loss: 0.732256
validation finished
Epoch-5 lr: 8.5e-06
epoch 5 training time: 21.567
---------------
2023-05-11 15:03:59.499803
current #epochs=6, #steps=240
start validation
mAP: 0.105352
AUC: 0.577484
Avg Precision: 0.097899
Avg Recall: 1.000000
d_prime: 0.276425
train_loss: 0.148217
valid_loss: 0.728828
validation finished
Epoch-6 lr: 7.2249999999999994e-06
epoch 6 training time: 21.360
---------------
2023-05-11 15:04:20.861440
current #epochs=7, #steps=288
Epoch: [7][12/48]	Per Sample Total Time 0.02953	Per Sample Data Time 0.00499	Per Sample DNN Time 0.02454	Train Loss 0.1423	
start validation
mAP: 0.110313
AUC: 0.588962
Avg Precision: 0.102643
Avg Recall: 1.000000
d_prime: 0.318022
train_loss: 0.142906
valid_loss: 0.725309
validation finished
Epoch-7 lr: 6.141249999999999e-06
epoch 7 training time: 21.999
---------------
2023-05-11 15:04:42.860003
current #epochs=8, #steps=336
start validation
mAP: 0.113600
AUC: 0.584122
Avg Precision: 0.107159
Avg Recall: 1.000000
d_prime: 0.300450
train_loss: 0.137273
valid_loss: 0.723424
validation finished
Epoch-8 lr: 5.220062499999999e-06
epoch 8 training time: 21.392
---------------
2023-05-11 15:05:04.251971
current #epochs=9, #steps=384
Epoch: [9][16/48]	Per Sample Total Time 0.02914	Per Sample Data Time 0.00491	Per Sample DNN Time 0.02423	Train Loss 0.1356	
start validation
mAP: 0.112764
AUC: 0.577978
Avg Precision: 0.105242
Avg Recall: 1.000000
d_prime: 0.278207
train_loss: 0.137052
valid_loss: 0.722227
validation finished
Epoch-9 lr: 4.4370531249999995e-06
epoch 9 training time: 18.525
---------------
2023-05-11 15:05:22.777408
current #epochs=10, #steps=432
start validation
mAP: 0.114937
AUC: 0.587659
Avg Precision: 0.105821
Avg Recall: 1.000000
d_prime: 0.313288
train_loss: 0.136247
valid_loss: 0.721305
validation finished
Epoch-10 lr: 3.7714951562499997e-06
epoch 10 training time: 22.067
---------------
2023-05-11 15:05:44.843685
current #epochs=11, #steps=480
Epoch: [11][20/48]	Per Sample Total Time 0.02874	Per Sample Data Time 0.00499	Per Sample DNN Time 0.02375	Train Loss 0.1357	
start validation
mAP: 0.115489
AUC: 0.587828
Avg Precision: 0.106076
Avg Recall: 1.000000
d_prime: 0.313900
train_loss: 0.133270
valid_loss: 0.720478
validation finished
Epoch-11 lr: 3.2057708828124997e-06
epoch 11 training time: 21.292
---------------
2023-05-11 15:06:06.136346
current #epochs=12, #steps=528
start validation
mAP: 0.116432
AUC: 0.592190
Avg Precision: 0.107751
Avg Recall: 1.000000
d_prime: 0.329769
train_loss: 0.132633
valid_loss: 0.719606
validation finished
Epoch-12 lr: 2.7249052503906246e-06
epoch 12 training time: 24.452
---------------
2023-05-11 15:06:30.589213
current #epochs=13, #steps=576
Epoch: [13][24/48]	Per Sample Total Time 0.02879	Per Sample Data Time 0.00487	Per Sample DNN Time 0.02392	Train Loss 0.1290	
start validation
mAP: 0.113338
AUC: 0.575082
Avg Precision: 0.103637
Avg Recall: 1.000000
d_prime: 0.267749
train_loss: 0.130770
valid_loss: 0.719162
validation finished
Epoch-13 lr: 2.316169462832031e-06
epoch 13 training time: 18.558
---------------
2023-05-11 15:06:49.146394
current #epochs=14, #steps=624
start validation
mAP: 0.122965
AUC: 0.583181
Avg Precision: 0.114165
Avg Recall: 1.000000
d_prime: 0.297039
train_loss: 0.132159
valid_loss: 0.718585
validation finished
Epoch-14 lr: 1.9687440434072264e-06
epoch 14 training time: 21.568
---------------
2023-05-11 15:07:10.715681
current #epochs=15, #steps=672
Epoch: [15][28/48]	Per Sample Total Time 0.02886	Per Sample Data Time 0.00496	Per Sample DNN Time 0.02389	Train Loss 0.1305	
start validation
mAP: 0.127551
AUC: 0.582551
Avg Precision: 0.115397
Avg Recall: 1.000000
d_prime: 0.294754
train_loss: 0.131231
valid_loss: 0.718293
validation finished
Epoch-15 lr: 1.6734324368961425e-06
epoch 15 training time: 21.578
---------------
2023-05-11 15:07:32.294236
current #epochs=16, #steps=720
start validation
mAP: 0.128675
AUC: 0.592780
Avg Precision: 0.119059
Avg Recall: 1.000000
d_prime: 0.331920
train_loss: 0.131432
valid_loss: 0.717932
validation finished
Epoch-16 lr: 1.422417571361721e-06
epoch 16 training time: 21.495
---------------
2023-05-11 15:07:53.788712
current #epochs=17, #steps=768
Epoch: [17][32/48]	Per Sample Total Time 0.02865	Per Sample Data Time 0.00488	Per Sample DNN Time 0.02377	Train Loss 0.1328	
start validation
mAP: 0.127614
AUC: 0.585933
Avg Precision: 0.118175
Avg Recall: 1.000000
d_prime: 0.307018
train_loss: 0.132339
valid_loss: 0.717645
validation finished
Epoch-17 lr: 1.2090549356574628e-06
epoch 17 training time: 18.512
---------------
2023-05-11 15:08:12.300505
current #epochs=18, #steps=816
start validation
mAP: 0.129220
AUC: 0.586490
Avg Precision: 0.121141
Avg Recall: 1.000000
d_prime: 0.309042
train_loss: 0.132216
valid_loss: 0.717540
validation finished
Epoch-18 lr: 1.0276966953088434e-06
epoch 18 training time: 21.374
---------------
2023-05-11 15:08:33.674984
current #epochs=19, #steps=864
Epoch: [19][36/48]	Per Sample Total Time 0.02880	Per Sample Data Time 0.00485	Per Sample DNN Time 0.02395	Train Loss 0.1275	
start validation
mAP: 0.139325
AUC: 0.589708
Avg Precision: 0.130897
Avg Recall: 1.000000
d_prime: 0.320734
train_loss: 0.128926
valid_loss: 0.717301
validation finished
Epoch-19 lr: 8.735421910125168e-07
epoch 19 training time: 21.338
---------------
2023-05-11 15:08:55.013254
current #epochs=20, #steps=912
start validation
mAP: 0.137310
AUC: 0.585999
Avg Precision: 0.129228
Avg Recall: 1.000000
d_prime: 0.307260
train_loss: 0.130491
valid_loss: 0.717201
validation finished
Epoch-20 lr: 7.425108623606393e-07
epoch 20 training time: 18.641
---------------
2023-05-11 15:09:13.654415
current #epochs=21, #steps=960
Epoch: [21][40/48]	Per Sample Total Time 0.02874	Per Sample Data Time 0.00486	Per Sample DNN Time 0.02388	Train Loss 0.1279	
start validation
mAP: 0.136779
AUC: 0.591361
Avg Precision: 0.130577
Avg Recall: 1.000000
d_prime: 0.326750
train_loss: 0.128707
valid_loss: 0.716965
validation finished
Epoch-21 lr: 6.311342330065434e-07
epoch 21 training time: 18.455
---------------
2023-05-11 15:09:32.109116
current #epochs=22, #steps=1008
start validation
mAP: 0.139967
AUC: 0.597953
Avg Precision: 0.131712
Avg Recall: 1.000000
d_prime: 0.350798
train_loss: 0.129834
valid_loss: 0.716865
validation finished
Epoch-22 lr: 5.364640980555618e-07
epoch 22 training time: 21.971
---------------
2023-05-11 15:09:54.079871
current #epochs=23, #steps=1056
Epoch: [23][44/48]	Per Sample Total Time 0.02875	Per Sample Data Time 0.00487	Per Sample DNN Time 0.02387	Train Loss 0.1307	
start validation
mAP: 0.139236
AUC: 0.594697
Avg Precision: 0.129949
Avg Recall: 1.000000
d_prime: 0.338909
train_loss: 0.129839
valid_loss: 0.716808
validation finished
Epoch-23 lr: 4.5599448334722756e-07
epoch 23 training time: 18.637
---------------
2023-05-11 15:10:12.716500
current #epochs=24, #steps=1104
start validation
mAP: 0.142565
AUC: 0.603415
Avg Precision: 0.131794
Avg Recall: 1.000000
d_prime: 0.370800
train_loss: 0.126138
valid_loss: 0.716652
validation finished
Epoch-24 lr: 3.875953108451434e-07
epoch 24 training time: 21.203
---------------
2023-05-11 15:10:33.919284
current #epochs=25, #steps=1152
start validation
mAP: 0.142572
AUC: 0.598642
Avg Precision: 0.132377
Avg Recall: 1.000000
d_prime: 0.353319
train_loss: 0.130550
valid_loss: 0.716585
validation finished
Epoch-25 lr: 3.294560142183719e-07
epoch 25 training time: 21.203
---------------
2023-05-11 15:10:55.122904
current #epochs=26, #steps=1200
Epoch: [26][0/48]	Per Sample Total Time 0.03096	Per Sample Data Time 0.00519	Per Sample DNN Time 0.02577	Train Loss 0.1053	
start validation
mAP: 0.133522
AUC: 0.591023
Avg Precision: 0.123072
Avg Recall: 1.000000
d_prime: 0.325522
train_loss: 0.129477
valid_loss: 0.716562
validation finished
Epoch-26 lr: 2.800376120856161e-07
epoch 26 training time: 18.592
---------------
2023-05-11 15:11:13.714749
current #epochs=27, #steps=1248
start validation
mAP: 0.138137
AUC: 0.596125
Avg Precision: 0.131718
Avg Recall: 1.000000
d_prime: 0.344120
train_loss: 0.128417
valid_loss: 0.716486
validation finished
Epoch-27 lr: 2.380319702727737e-07
epoch 27 training time: 18.568
---------------
2023-05-11 15:11:32.282280
current #epochs=28, #steps=1296
Epoch: [28][4/48]	Per Sample Total Time 0.02889	Per Sample Data Time 0.00509	Per Sample DNN Time 0.02380	Train Loss 0.1279	
start validation
mAP: 0.139445
AUC: 0.601889
Avg Precision: 0.132083
Avg Recall: 1.000000
d_prime: 0.365206
train_loss: 0.126813
valid_loss: 0.716415
validation finished
Epoch-28 lr: 2.0232717473185765e-07
epoch 28 training time: 18.839
---------------
2023-05-11 15:11:51.121390
current #epochs=29, #steps=1344
start validation
mAP: 0.140849
AUC: 0.603280
Avg Precision: 0.131730
Avg Recall: 1.000000
d_prime: 0.370307
train_loss: 0.130045
valid_loss: 0.716385
validation finished
Epoch-29 lr: 1.71978098522079e-07
epoch 29 training time: 18.695
---------------
2023-05-11 15:12:09.817484
current #epochs=30, #steps=1392
Epoch: [30][8/48]	Per Sample Total Time 0.02863	Per Sample Data Time 0.00487	Per Sample DNN Time 0.02375	Train Loss 0.1346	
start validation
mAP: 0.139603
AUC: 0.599684
Avg Precision: 0.131374
Avg Recall: 1.000000
d_prime: 0.357130
train_loss: 0.128713
valid_loss: 0.716353
validation finished
Epoch-30 lr: 1.4618138374376713e-07
epoch 30 training time: 18.572
---------------evaluate on the train, validation, test set---------------
now train a audio spectrogram transformer model
---------------AST Model Summary---------------
ImageNet pretraining: True, AudioSet pretraining: True
frequncey stride=10, time stride=10
number of patches=600
balanced sampler is being used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
(571, 88)
train auc:  0.7011953349169873
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
(68, 88)
val auc:  0.5521190665864616
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
(48, 88)
eval auc:  0.5786457338114133
I am process 22740, running on gpu38: starting (Thu May 11 15:12:45 2023)
args:  Namespace(data_train='./data/datafiles/train.json', data_val='./data/datafiles/eval.json', data_eval='./data/datafiles/test.json', label_csv='./data/class_labels_indices.csv', n_class=88, model='ast', dataset='audioset', exp_dir='./exp/ast-attempt7-nobal', lr=1e-05, optim='adam', batch_size=12, num_workers=0, n_epochs=30, lr_patience=2, n_print_steps=100, save_model=True, freqm=24, timem=96, mixup=0.0, bal='False', fstride=10, tstride=10, imagenet_pretrain=True, audioset_pretrain=True, dataset_mean=-0.000321335, dataset_std=0.003499322, audio_length=512, noise=False, metrics='mAP', loss='BCE', warmup=False, lrscheduler_start=5, lrscheduler_step=1, lrscheduler_decay=0.85, wa=True, wa_start=1, wa_end=5)
now train a audio spectrogram transformer model
balanced sampler is not used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
---------------AST Model Summary---------------
ImageNet pretraining: True, AudioSet pretraining: True
frequncey stride=10, time stride=10
number of patches=600

Creating experiment directory: ./exp/ast-attempt7-nobal
Now starting training for 30 epochs
running on cuda
Total parameter number is : 87.324 million
Total trainable parameter number is : 87.324 million
now training with audioset, main metrics: mAP, loss function: BCEWithLogitsLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f5366b9a970>
The learning rate scheduler starts at 5 epoch with decay rate of 0.850 every 1 epochs
current #steps=0, #epochs=1
start training...
---------------
2023-05-11 15:12:48.578446
current #epochs=1, #steps=0
start validation
mAP: 0.083030
AUC: 0.532362
Avg Precision: 0.074184
Avg Recall: 1.000000
d_prime: 0.114848
train_loss: 0.355631
valid_loss: 0.776176
validation finished
Epoch-1 lr: 1e-05
epoch 1 training time: 30.697
---------------
2023-05-11 15:13:19.276184
current #epochs=2, #steps=48
start validation
mAP: 0.080863
AUC: 0.544434
Avg Precision: 0.072725
Avg Recall: 1.000000
d_prime: 0.157841
train_loss: 0.181789
valid_loss: 0.753975
validation finished
Epoch-2 lr: 1e-05
epoch 2 training time: 18.849
---------------
2023-05-11 15:13:38.125296
current #epochs=3, #steps=96
Epoch: [3][4/48]	Per Sample Total Time 0.02815	Per Sample Data Time 0.00459	Per Sample DNN Time 0.02356	Train Loss 0.1723	
start validation
mAP: 0.083413
AUC: 0.562703
Avg Precision: 0.069706
Avg Recall: 1.000000
d_prime: 0.223198
train_loss: 0.157940
valid_loss: 0.742957
validation finished
Epoch-3 lr: 1e-05
epoch 3 training time: 29.711
---------------
2023-05-11 15:14:07.836985
current #epochs=4, #steps=144
start validation
mAP: 0.089630
AUC: 0.585530
Avg Precision: 0.077392
Avg Recall: 1.000000
d_prime: 0.305557
train_loss: 0.142680
valid_loss: 0.734967
validation finished
Epoch-4 lr: 1e-05
epoch 4 training time: 21.988
---------------
2023-05-11 15:14:29.826543
current #epochs=5, #steps=192
Epoch: [5][8/48]	Per Sample Total Time 0.02960	Per Sample Data Time 0.00478	Per Sample DNN Time 0.02481	Train Loss 0.1360	
start validation
mAP: 0.095823
AUC: 0.598796
Avg Precision: 0.081197
Avg Recall: 1.000000
d_prime: 0.353880
train_loss: 0.131722
valid_loss: 0.729131
validation finished
Epoch-5 lr: 8.5e-06
epoch 5 training time: 22.066
---------------
2023-05-11 15:14:51.892091
current #epochs=6, #steps=240
start validation
mAP: 0.098908
AUC: 0.595026
Avg Precision: 0.083801
Avg Recall: 1.000000
d_prime: 0.340109
train_loss: 0.124386
valid_loss: 0.725120
validation finished
Epoch-6 lr: 7.2249999999999994e-06
epoch 6 training time: 21.179
---------------
2023-05-11 15:15:13.071438
current #epochs=7, #steps=288
Epoch: [7][12/48]	Per Sample Total Time 0.02861	Per Sample Data Time 0.00499	Per Sample DNN Time 0.02362	Train Loss 0.1192	
start validation
mAP: 0.098904
AUC: 0.593782
Avg Precision: 0.080694
Avg Recall: 1.000000
d_prime: 0.335571
train_loss: 0.119218
valid_loss: 0.722463
validation finished
Epoch-7 lr: 6.141249999999999e-06
epoch 7 training time: 18.908
---------------
2023-05-11 15:15:31.978717
current #epochs=8, #steps=336
start validation
mAP: 0.098456
AUC: 0.593902
Avg Precision: 0.083746
Avg Recall: 1.000000
d_prime: 0.336009
train_loss: 0.115853
valid_loss: 0.720535
validation finished
Epoch-8 lr: 5.220062499999999e-06
epoch 8 training time: 18.565
---------------
2023-05-11 15:15:50.543576
current #epochs=9, #steps=384
Epoch: [9][16/48]	Per Sample Total Time 0.02851	Per Sample Data Time 0.00478	Per Sample DNN Time 0.02374	Train Loss 0.1149	
start validation
mAP: 0.094790
AUC: 0.595996
Avg Precision: 0.082760
Avg Recall: 1.000000
d_prime: 0.343650
train_loss: 0.113452
valid_loss: 0.718832
validation finished
Epoch-9 lr: 4.4370531249999995e-06
epoch 9 training time: 18.565
---------------
2023-05-11 15:16:09.108726
current #epochs=10, #steps=432
start validation
mAP: 0.094063
AUC: 0.598242
Avg Precision: 0.081701
Avg Recall: 1.000000
d_prime: 0.351854
train_loss: 0.111493
valid_loss: 0.717695
validation finished
Epoch-10 lr: 3.7714951562499997e-06
epoch 10 training time: 18.353
---------------
2023-05-11 15:16:27.461953
current #epochs=11, #steps=480
Epoch: [11][20/48]	Per Sample Total Time 0.02861	Per Sample Data Time 0.00492	Per Sample DNN Time 0.02369	Train Loss 0.1118	
start validation
mAP: 0.093280
AUC: 0.598328
Avg Precision: 0.084205
Avg Recall: 1.000000
d_prime: 0.352170
train_loss: 0.110077
valid_loss: 0.716788
validation finished
Epoch-11 lr: 3.2057708828124997e-06
epoch 11 training time: 18.328
---------------
2023-05-11 15:16:45.790975
current #epochs=12, #steps=528
start validation
mAP: 0.097020
AUC: 0.596882
Avg Precision: 0.084775
Avg Recall: 1.000000
d_prime: 0.346886
train_loss: 0.109007
valid_loss: 0.716035
validation finished
Epoch-12 lr: 2.7249052503906246e-06
epoch 12 training time: 18.608
---------------
2023-05-11 15:17:04.398218
current #epochs=13, #steps=576
Epoch: [13][24/48]	Per Sample Total Time 0.02850	Per Sample Data Time 0.00479	Per Sample DNN Time 0.02371	Train Loss 0.1079	
start validation
mAP: 0.096836
AUC: 0.598552
Avg Precision: 0.084297
Avg Recall: 1.000000
d_prime: 0.352990
train_loss: 0.108179
valid_loss: 0.715415
validation finished
Epoch-13 lr: 2.316169462832031e-06
epoch 13 training time: 18.979
---------------
2023-05-11 15:17:23.378402
current #epochs=14, #steps=624
start validation
mAP: 0.097520
AUC: 0.590913
Avg Precision: 0.084723
Avg Recall: 1.000000
d_prime: 0.325121
train_loss: 0.107492
valid_loss: 0.715072
validation finished
Epoch-14 lr: 1.9687440434072264e-06
epoch 14 training time: 18.613
---------------
2023-05-11 15:17:41.990289
current #epochs=15, #steps=672
Epoch: [15][28/48]	Per Sample Total Time 0.02855	Per Sample Data Time 0.00483	Per Sample DNN Time 0.02372	Train Loss 0.1070	
start validation
mAP: 0.095850
AUC: 0.594750
Avg Precision: 0.086707
Avg Recall: 1.000000
d_prime: 0.339101
train_loss: 0.106889
valid_loss: 0.714612
validation finished
Epoch-15 lr: 1.6734324368961425e-06
epoch 15 training time: 18.473
---------------
2023-05-11 15:18:00.462981
current #epochs=16, #steps=720
start validation
mAP: 0.098292
AUC: 0.599695
Avg Precision: 0.086712
Avg Recall: 1.000000
d_prime: 0.357172
train_loss: 0.106435
valid_loss: 0.714298
validation finished
Epoch-16 lr: 1.422417571361721e-06
epoch 16 training time: 18.657
---------------
2023-05-11 15:18:19.119569
current #epochs=17, #steps=768
Epoch: [17][32/48]	Per Sample Total Time 0.02858	Per Sample Data Time 0.00488	Per Sample DNN Time 0.02370	Train Loss 0.1079	
start validation
mAP: 0.095605
AUC: 0.589790
Avg Precision: 0.087446
Avg Recall: 1.000000
d_prime: 0.321032
train_loss: 0.106017
valid_loss: 0.714040
validation finished
Epoch-17 lr: 1.2090549356574628e-06
epoch 17 training time: 18.440
---------------
2023-05-11 15:18:37.560736
current #epochs=18, #steps=816
start validation
mAP: 0.094492
AUC: 0.589112
Avg Precision: 0.086264
Avg Recall: 1.000000
d_prime: 0.318568
train_loss: 0.105718
valid_loss: 0.713835
validation finished
Epoch-18 lr: 1.0276966953088434e-06
epoch 18 training time: 18.514
---------------
2023-05-11 15:18:56.073690
current #epochs=19, #steps=864
Epoch: [19][36/48]	Per Sample Total Time 0.02845	Per Sample Data Time 0.00476	Per Sample DNN Time 0.02369	Train Loss 0.1067	
start validation
mAP: 0.096709
AUC: 0.600437
Avg Precision: 0.088370
Avg Recall: 1.000000
d_prime: 0.359887
train_loss: 0.105425
valid_loss: 0.713609
validation finished
Epoch-19 lr: 8.735421910125168e-07
epoch 19 training time: 19.832
---------------
2023-05-11 15:19:15.907169
current #epochs=20, #steps=912
start validation
mAP: 0.098427
AUC: 0.593841
Avg Precision: 0.089618
Avg Recall: 1.000000
d_prime: 0.335785
train_loss: 0.105210
valid_loss: 0.713436
validation finished
Epoch-20 lr: 7.425108623606393e-07
epoch 20 training time: 18.498
---------------
2023-05-11 15:19:34.404605
current #epochs=21, #steps=960
Epoch: [21][40/48]	Per Sample Total Time 0.02851	Per Sample Data Time 0.00486	Per Sample DNN Time 0.02365	Train Loss 0.1061	
start validation
mAP: 0.099415
AUC: 0.592641
Avg Precision: 0.090950
Avg Recall: 1.000000
d_prime: 0.331413
train_loss: 0.105170
valid_loss: 0.713288
validation finished
Epoch-21 lr: 6.311342330065434e-07
epoch 21 training time: 21.343
---------------
2023-05-11 15:19:55.748383
current #epochs=22, #steps=1008
start validation
mAP: 0.095864
AUC: 0.591438
Avg Precision: 0.087914
Avg Recall: 1.000000
d_prime: 0.327030
train_loss: 0.104868
valid_loss: 0.713201
validation finished
Epoch-22 lr: 5.364640980555618e-07
epoch 22 training time: 18.474
---------------
2023-05-11 15:20:14.221827
current #epochs=23, #steps=1056
Epoch: [23][44/48]	Per Sample Total Time 0.02850	Per Sample Data Time 0.00481	Per Sample DNN Time 0.02369	Train Loss 0.1053	
start validation
mAP: 0.096645
AUC: 0.589282
Avg Precision: 0.088268
Avg Recall: 1.000000
d_prime: 0.319185
train_loss: 0.104772
valid_loss: 0.713093
validation finished
Epoch-23 lr: 4.5599448334722756e-07
epoch 23 training time: 18.414
---------------
2023-05-11 15:20:32.636140
current #epochs=24, #steps=1104
start validation
mAP: 0.098801
AUC: 0.587755
Avg Precision: 0.088317
Avg Recall: 1.000000
d_prime: 0.313635
train_loss: 0.104596
valid_loss: 0.713026
validation finished
Epoch-24 lr: 3.875953108451434e-07
epoch 24 training time: 18.380
---------------
2023-05-11 15:20:51.016247
current #epochs=25, #steps=1152
start validation
mAP: 0.098962
AUC: 0.591111
Avg Precision: 0.091567
Avg Recall: 1.000000
d_prime: 0.325839
train_loss: 0.104557
valid_loss: 0.712954
validation finished
Epoch-25 lr: 3.294560142183719e-07
epoch 25 training time: 18.403
---------------
2023-05-11 15:21:09.419970
current #epochs=26, #steps=1200
Epoch: [26][0/48]	Per Sample Total Time 0.02902	Per Sample Data Time 0.00527	Per Sample DNN Time 0.02375	Train Loss 0.1049	
start validation
mAP: 0.100347
AUC: 0.592126
Avg Precision: 0.089537
Avg Recall: 1.000000
d_prime: 0.329536
train_loss: 0.104444
valid_loss: 0.712898
validation finished
Epoch-26 lr: 2.800376120856161e-07
epoch 26 training time: 21.433
---------------
2023-05-11 15:21:30.852904
current #epochs=27, #steps=1248
start validation
mAP: 0.099928
AUC: 0.591926
Avg Precision: 0.088740
Avg Recall: 1.000000
d_prime: 0.328809
train_loss: 0.104503
valid_loss: 0.712851
validation finished
Epoch-27 lr: 2.380319702727737e-07
epoch 27 training time: 18.699
---------------
2023-05-11 15:21:49.550816
current #epochs=28, #steps=1296
Epoch: [28][4/48]	Per Sample Total Time 0.02818	Per Sample Data Time 0.00471	Per Sample DNN Time 0.02347	Train Loss 0.1062	
start validation
mAP: 0.101176
AUC: 0.591383
Avg Precision: 0.091549
Avg Recall: 1.000000
d_prime: 0.326830
train_loss: 0.104491
valid_loss: 0.712797
validation finished
Epoch-28 lr: 2.0232717473185765e-07
epoch 28 training time: 21.753
---------------
2023-05-11 15:22:11.304607
current #epochs=29, #steps=1344
start validation
mAP: 0.102770
AUC: 0.593912
Avg Precision: 0.090280
Avg Recall: 1.000000
d_prime: 0.336045
train_loss: 0.104279
valid_loss: 0.712763
validation finished
Epoch-29 lr: 1.71978098522079e-07
epoch 29 training time: 22.047
---------------
2023-05-11 15:22:33.351624
current #epochs=30, #steps=1392
Epoch: [30][8/48]	Per Sample Total Time 0.02868	Per Sample Data Time 0.00480	Per Sample DNN Time 0.02388	Train Loss 0.1002	
start validation
mAP: 0.099131
AUC: 0.591949
Avg Precision: 0.090501
Avg Recall: 1.000000
d_prime: 0.328891
train_loss: 0.104229
valid_loss: 0.712729
validation finished
Epoch-30 lr: 1.4618138374376713e-07
epoch 30 training time: 18.445
---------------Training Finished---------------
weighted averaged model results
mAP: 0.085266
AUC: 0.571170
Avg Precision: 0.074034
Avg Recall: 1.000000
d_prime: 0.253644
train_loss: 0.000000
valid_loss: 0.712729
---------------evaluate on the train, validation, test set---------------
now train a audio spectrogram transformer model
---------------AST Model Summary---------------
ImageNet pretraining: True, AudioSet pretraining: True
frequncey stride=10, time stride=10
number of patches=600
balanced sampler is not used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
(571, 88)
train auc:  0.6717685159395316
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
(68, 88)
val auc:  0.6163007310583275
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
(48, 88)
eval auc:  0.6171248890037879
I am process 29451, running on gpu38: starting (Thu May 11 15:23:11 2023)
args:  Namespace(data_train='./data/datafiles/train.json', data_val='./data/datafiles/eval.json', data_eval='./data/datafiles/test.json', label_csv='./data/class_labels_indices.csv', n_class=88, model='ast', dataset='audioset', exp_dir='./exp/ast-attempt8-mixup0.4', lr=1e-05, optim='adam', batch_size=12, num_workers=0, n_epochs=30, lr_patience=2, n_print_steps=100, save_model=True, freqm=24, timem=96, mixup=0.4, bal='bal', fstride=10, tstride=10, imagenet_pretrain=True, audioset_pretrain=True, dataset_mean=-0.000321335, dataset_std=0.003499322, audio_length=512, noise=False, metrics='mAP', loss='BCE', warmup=False, lrscheduler_start=5, lrscheduler_step=1, lrscheduler_decay=0.85, wa=True, wa_start=1, wa_end=5)
now train a audio spectrogram transformer model
balanced sampler is being used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.400000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
---------------AST Model Summary---------------
ImageNet pretraining: True, AudioSet pretraining: True
frequncey stride=10, time stride=10
number of patches=600

Creating experiment directory: ./exp/ast-attempt8-mixup0.4
Now starting training for 30 epochs
running on cuda
Total parameter number is : 87.324 million
Total trainable parameter number is : 87.324 million
now training with audioset, main metrics: mAP, loss function: BCEWithLogitsLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fd1c531fa60>
The learning rate scheduler starts at 5 epoch with decay rate of 0.850 every 1 epochs
current #steps=0, #epochs=1
start training...
---------------
2023-05-11 15:23:15.271311
current #epochs=1, #steps=0
start validation
mAP: 0.086812
AUC: 0.516540
Avg Precision: 0.071389
Avg Recall: 1.000000
d_prime: 0.058649
train_loss: 0.367498
valid_loss: 0.773776
validation finished
Epoch-1 lr: 1e-05
epoch 1 training time: 30.917
---------------
2023-05-11 15:23:46.188298
current #epochs=2, #steps=48
start validation
mAP: 0.080773
AUC: 0.505191
Avg Precision: 0.067511
Avg Recall: 1.000000
d_prime: 0.018403
train_loss: 0.191326
valid_loss: 0.752392
validation finished
Epoch-2 lr: 1e-05
epoch 2 training time: 18.934
---------------
2023-05-11 15:24:05.123040
current #epochs=3, #steps=96
Epoch: [3][4/48]	Per Sample Total Time 0.02940	Per Sample Data Time 0.00571	Per Sample DNN Time 0.02369	Train Loss 0.1778	
start validation
mAP: 0.077556
AUC: 0.506319
Avg Precision: 0.067988
Avg Recall: 1.000000
d_prime: 0.022402
train_loss: 0.167189
valid_loss: 0.742229
validation finished
Epoch-3 lr: 1e-05
epoch 3 training time: 19.057
---------------
2023-05-11 15:24:24.179843
current #epochs=4, #steps=144
start validation
mAP: 0.100133
AUC: 0.530015
Avg Precision: 0.084541
Avg Recall: 1.000000
d_prime: 0.106501
train_loss: 0.157867
valid_loss: 0.735176
validation finished
Epoch-4 lr: 1e-05
epoch 4 training time: 21.679
---------------
2023-05-11 15:24:45.859220
current #epochs=5, #steps=192
Epoch: [5][8/48]	Per Sample Total Time 0.02941	Per Sample Data Time 0.00555	Per Sample DNN Time 0.02386	Train Loss 0.1481	
start validation
mAP: 0.097380
AUC: 0.542022
Avg Precision: 0.085083
Avg Recall: 1.000000
d_prime: 0.149242
train_loss: 0.146107
valid_loss: 0.729670
validation finished
Epoch-5 lr: 8.5e-06
epoch 5 training time: 18.944
---------------
2023-05-11 15:25:04.802430
current #epochs=6, #steps=240
start validation
mAP: 0.110348
AUC: 0.554653
Avg Precision: 0.096348
Avg Recall: 1.000000
d_prime: 0.194349
train_loss: 0.140445
valid_loss: 0.725857
validation finished
Epoch-6 lr: 7.2249999999999994e-06
epoch 6 training time: 22.790
---------------
2023-05-11 15:25:27.592908
current #epochs=7, #steps=288
Epoch: [7][12/48]	Per Sample Total Time 0.02916	Per Sample Data Time 0.00545	Per Sample DNN Time 0.02371	Train Loss 0.1389	
start validation
mAP: 0.115737
AUC: 0.558389
Avg Precision: 0.102734
Avg Recall: 1.000000
d_prime: 0.207727
train_loss: 0.138619
valid_loss: 0.723714
validation finished
Epoch-7 lr: 6.141249999999999e-06
epoch 7 training time: 23.309
---------------
2023-05-11 15:25:50.902199
current #epochs=8, #steps=336
start validation
mAP: 0.114877
AUC: 0.576116
Avg Precision: 0.100671
Avg Recall: 1.000000
d_prime: 0.271482
train_loss: 0.131242
valid_loss: 0.721684
validation finished
Epoch-8 lr: 5.220062499999999e-06
epoch 8 training time: 19.756
---------------
2023-05-11 15:26:10.658795
current #epochs=9, #steps=384
Epoch: [9][16/48]	Per Sample Total Time 0.02906	Per Sample Data Time 0.00536	Per Sample DNN Time 0.02370	Train Loss 0.1332	
start validation
mAP: 0.116957
AUC: 0.581671
Avg Precision: 0.102770
Avg Recall: 1.000000
d_prime: 0.291570
train_loss: 0.131907
valid_loss: 0.720266
validation finished
Epoch-9 lr: 4.4370531249999995e-06
epoch 9 training time: 21.839
---------------
2023-05-11 15:26:32.496934
current #epochs=10, #steps=432
start validation
mAP: 0.114503
AUC: 0.570464
Avg Precision: 0.101744
Avg Recall: 1.000000
d_prime: 0.251102
train_loss: 0.130620
valid_loss: 0.719487
validation finished
Epoch-10 lr: 3.7714951562499997e-06
epoch 10 training time: 18.949
---------------
2023-05-11 15:26:51.446823
current #epochs=11, #steps=480
Epoch: [11][20/48]	Per Sample Total Time 0.02949	Per Sample Data Time 0.00547	Per Sample DNN Time 0.02402	Train Loss 0.1314	
start validation
mAP: 0.115541
AUC: 0.575257
Avg Precision: 0.103384
Avg Recall: 1.000000
d_prime: 0.268381
train_loss: 0.130373
valid_loss: 0.718440
validation finished
Epoch-11 lr: 3.2057708828124997e-06
epoch 11 training time: 18.870
---------------
2023-05-11 15:27:10.316596
current #epochs=12, #steps=528
start validation
mAP: 0.115706
AUC: 0.586883
Avg Precision: 0.102878
Avg Recall: 1.000000
d_prime: 0.310469
train_loss: 0.125788
valid_loss: 0.717641
validation finished
Epoch-12 lr: 2.7249052503906246e-06
epoch 12 training time: 18.927
---------------
2023-05-11 15:27:29.243864
current #epochs=13, #steps=576
Epoch: [13][24/48]	Per Sample Total Time 0.02941	Per Sample Data Time 0.00544	Per Sample DNN Time 0.02397	Train Loss 0.1264	
start validation
mAP: 0.118230
AUC: 0.588778
Avg Precision: 0.105251
Avg Recall: 1.000000
d_prime: 0.317352
train_loss: 0.127277
valid_loss: 0.717152
validation finished
Epoch-13 lr: 2.316169462832031e-06
epoch 13 training time: 21.989
---------------
2023-05-11 15:27:51.232583
current #epochs=14, #steps=624
start validation
mAP: 0.118582
AUC: 0.588533
Avg Precision: 0.104294
Avg Recall: 1.000000
d_prime: 0.316463
train_loss: 0.125657
valid_loss: 0.716808
validation finished
Epoch-14 lr: 1.9687440434072264e-06
epoch 14 training time: 21.588
---------------
2023-05-11 15:28:12.821691
current #epochs=15, #steps=672
Epoch: [15][28/48]	Per Sample Total Time 0.02944	Per Sample Data Time 0.00537	Per Sample DNN Time 0.02407	Train Loss 0.1258	
start validation
mAP: 0.119052
AUC: 0.592132
Avg Precision: 0.106578
Avg Recall: 1.000000
d_prime: 0.329558
train_loss: 0.126348
valid_loss: 0.716507
validation finished
Epoch-15 lr: 1.6734324368961425e-06
epoch 15 training time: 21.658
---------------
2023-05-11 15:28:34.478601
current #epochs=16, #steps=720
start validation
mAP: 0.120551
AUC: 0.594221
Avg Precision: 0.105964
Avg Recall: 1.000000
d_prime: 0.337171
train_loss: 0.128294
valid_loss: 0.716388
validation finished
Epoch-16 lr: 1.422417571361721e-06
epoch 16 training time: 22.045
---------------
2023-05-11 15:28:56.524831
current #epochs=17, #steps=768
Epoch: [17][32/48]	Per Sample Total Time 0.02957	Per Sample Data Time 0.00541	Per Sample DNN Time 0.02416	Train Loss 0.1276	
start validation
mAP: 0.126035
AUC: 0.596725
Avg Precision: 0.110508
Avg Recall: 1.000000
d_prime: 0.346310
train_loss: 0.125918
valid_loss: 0.716157
validation finished
Epoch-17 lr: 1.2090549356574628e-06
epoch 17 training time: 21.635
---------------
2023-05-11 15:29:18.158775
current #epochs=18, #steps=816
start validation
mAP: 0.123058
AUC: 0.596315
Avg Precision: 0.107618
Avg Recall: 1.000000
d_prime: 0.344814
train_loss: 0.127151
valid_loss: 0.715883
validation finished
Epoch-18 lr: 1.0276966953088434e-06
epoch 18 training time: 19.977
---------------
2023-05-11 15:29:38.137087
current #epochs=19, #steps=864
Epoch: [19][36/48]	Per Sample Total Time 0.02935	Per Sample Data Time 0.00545	Per Sample DNN Time 0.02390	Train Loss 0.1293	
start validation
mAP: 0.130438
AUC: 0.596224
Avg Precision: 0.111810
Avg Recall: 1.000000
d_prime: 0.344482
train_loss: 0.128762
valid_loss: 0.715792
validation finished
Epoch-19 lr: 8.735421910125168e-07
epoch 19 training time: 21.921
---------------
2023-05-11 15:30:00.057724
current #epochs=20, #steps=912
start validation
mAP: 0.128000
AUC: 0.597574
Avg Precision: 0.109681
Avg Recall: 1.000000
d_prime: 0.349415
train_loss: 0.127433
valid_loss: 0.715600
validation finished
Epoch-20 lr: 7.425108623606393e-07
epoch 20 training time: 18.968
---------------
2023-05-11 15:30:19.025431
current #epochs=21, #steps=960
Epoch: [21][40/48]	Per Sample Total Time 0.02908	Per Sample Data Time 0.00535	Per Sample DNN Time 0.02373	Train Loss 0.1233	
start validation
mAP: 0.126984
AUC: 0.597606
Avg Precision: 0.110655
Avg Recall: 1.000000
d_prime: 0.349532
train_loss: 0.123350
valid_loss: 0.715443
validation finished
Epoch-21 lr: 6.311342330065434e-07
epoch 21 training time: 18.835
---------------
2023-05-11 15:30:37.860727
current #epochs=22, #steps=1008
start validation
mAP: 0.125017
AUC: 0.600298
Avg Precision: 0.108607
Avg Recall: 1.000000
d_prime: 0.359377
train_loss: 0.123464
valid_loss: 0.715288
validation finished
Epoch-22 lr: 5.364640980555618e-07
epoch 22 training time: 18.950
---------------
2023-05-11 15:30:56.811076
current #epochs=23, #steps=1056
Epoch: [23][44/48]	Per Sample Total Time 0.02913	Per Sample Data Time 0.00538	Per Sample DNN Time 0.02376	Train Loss 0.1236	
start validation
mAP: 0.127805
AUC: 0.600215
Avg Precision: 0.111360
Avg Recall: 1.000000
d_prime: 0.359075
train_loss: 0.123746
valid_loss: 0.715135
validation finished
Epoch-23 lr: 4.5599448334722756e-07
epoch 23 training time: 18.738
---------------
2023-05-11 15:31:15.550282
current #epochs=24, #steps=1104
start validation
mAP: 0.127017
AUC: 0.599680
Avg Precision: 0.108950
Avg Recall: 1.000000
d_prime: 0.357115
train_loss: 0.125672
valid_loss: 0.715074
validation finished
Epoch-24 lr: 3.875953108451434e-07
epoch 24 training time: 19.108
---------------
2023-05-11 15:31:34.657207
current #epochs=25, #steps=1152
start validation
mAP: 0.126820
AUC: 0.599025
Avg Precision: 0.108981
Avg Recall: 1.000000
d_prime: 0.354720
train_loss: 0.125272
valid_loss: 0.715050
validation finished
Epoch-25 lr: 3.294560142183719e-07
epoch 25 training time: 18.751
---------------
2023-05-11 15:31:53.408360
current #epochs=26, #steps=1200
Epoch: [26][0/48]	Per Sample Total Time 0.02959	Per Sample Data Time 0.00573	Per Sample DNN Time 0.02386	Train Loss 0.1116	
start validation
mAP: 0.132372
AUC: 0.601823
Avg Precision: 0.113197
Avg Recall: 1.000000
d_prime: 0.364963
train_loss: 0.123603
valid_loss: 0.714960
validation finished
Epoch-26 lr: 2.800376120856161e-07
epoch 26 training time: 22.049
---------------
2023-05-11 15:32:15.456777
current #epochs=27, #steps=1248
start validation
mAP: 0.131036
AUC: 0.604580
Avg Precision: 0.114249
Avg Recall: 1.000000
d_prime: 0.375077
train_loss: 0.125529
valid_loss: 0.714900
validation finished
Epoch-27 lr: 2.380319702727737e-07
epoch 27 training time: 18.945
---------------
2023-05-11 15:32:34.401656
current #epochs=28, #steps=1296
Epoch: [28][4/48]	Per Sample Total Time 0.02898	Per Sample Data Time 0.00524	Per Sample DNN Time 0.02374	Train Loss 0.1217	
start validation
mAP: 0.127800
AUC: 0.602551
Avg Precision: 0.110071
Avg Recall: 1.000000
d_prime: 0.367634
train_loss: 0.125200
valid_loss: 0.714871
validation finished
Epoch-28 lr: 2.0232717473185765e-07
epoch 28 training time: 18.830
---------------
2023-05-11 15:32:53.232266
current #epochs=29, #steps=1344
start validation
mAP: 0.128364
AUC: 0.603441
Avg Precision: 0.110651
Avg Recall: 1.000000
d_prime: 0.370897
train_loss: 0.124002
valid_loss: 0.714820
validation finished
Epoch-29 lr: 1.71978098522079e-07
epoch 29 training time: 19.060
---------------
2023-05-11 15:33:12.291671
current #epochs=30, #steps=1392
Epoch: [30][8/48]	Per Sample Total Time 0.02894	Per Sample Data Time 0.00531	Per Sample DNN Time 0.02362	Train Loss 0.1242	
start validation
mAP: 0.128055
AUC: 0.602557
Avg Precision: 0.110438
Avg Recall: 1.000000
d_prime: 0.367655
train_loss: 0.126026
valid_loss: 0.714801
validation finished
Epoch-30 lr: 1.4618138374376713e-07
epoch 30 training time: 19.131
---------------Training Finished---------------
weighted averaged model results
mAP: 0.086198
AUC: 0.523457
Avg Precision: 0.073540
Avg Recall: 1.000000
d_prime: 0.083201
train_loss: 0.000000
valid_loss: 0.714801
---------------evaluate on the train, validation, test set---------------
now train a audio spectrogram transformer model
---------------AST Model Summary---------------
ImageNet pretraining: True, AudioSet pretraining: True
frequncey stride=10, time stride=10
number of patches=600
balanced sampler is being used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.400000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
(571, 88)
Traceback (most recent call last):
  File "/research/dept8/fyp22/lj2202/eleg5491/ast/egs/kaggle/../../src/run.py", line 178, in <module>
    evaluate(args.exp_dir)
  File "/research/dept8/fyp22/lj2202/eleg5491/ast/src/eval.py", line 79, in evaluate
    train_auc = sklearn.metrics.roc_auc_score(train_labels.ravel(),train_results.ravel())
  File "/research/dept8/fyp22/lj2202/anaconda3/envs/eleg5491/lib/python3.9/site-packages/sklearn/utils/validation.py", line 63, in inner_f
    return f(*args, **kwargs)
  File "/research/dept8/fyp22/lj2202/anaconda3/envs/eleg5491/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 547, in roc_auc_score
    return _average_binary_score(partial(_binary_roc_auc_score,
  File "/research/dept8/fyp22/lj2202/anaconda3/envs/eleg5491/lib/python3.9/site-packages/sklearn/metrics/_base.py", line 74, in _average_binary_score
    raise ValueError("{0} format is not supported".format(y_type))
ValueError: continuous format is not supported
I am process 36395, running on gpu38: starting (Thu May 11 15:33:50 2023)
args:  Namespace(data_train='./data/datafiles/train.json', data_val='./data/datafiles/eval.json', data_eval='./data/datafiles/test.json', label_csv='./data/class_labels_indices.csv', n_class=88, model='ast', dataset='audioset', exp_dir='./exp/ast-attempt9-mixup0.6', lr=1e-05, optim='adam', batch_size=12, num_workers=0, n_epochs=30, lr_patience=2, n_print_steps=100, save_model=True, freqm=24, timem=96, mixup=0.6, bal='bal', fstride=10, tstride=10, imagenet_pretrain=True, audioset_pretrain=True, dataset_mean=-0.000321335, dataset_std=0.003499322, audio_length=512, noise=False, metrics='mAP', loss='BCE', warmup=False, lrscheduler_start=5, lrscheduler_step=1, lrscheduler_decay=0.85, wa=True, wa_start=1, wa_end=5)
now train a audio spectrogram transformer model
balanced sampler is being used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.600000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
---------------AST Model Summary---------------
ImageNet pretraining: True, AudioSet pretraining: True
frequncey stride=10, time stride=10
number of patches=600

Creating experiment directory: ./exp/ast-attempt9-mixup0.6
Now starting training for 30 epochs
running on cuda
Total parameter number is : 87.324 million
Total trainable parameter number is : 87.324 million
now training with audioset, main metrics: mAP, loss function: BCEWithLogitsLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fdc136d30a0>
The learning rate scheduler starts at 5 epoch with decay rate of 0.850 every 1 epochs
current #steps=0, #epochs=1
start training...
---------------
2023-05-11 15:33:53.928698
current #epochs=1, #steps=0
start validation
mAP: 0.071723
AUC: 0.490948
Avg Precision: 0.071587
Avg Recall: 1.000000
d_prime: -0.032090
train_loss: 0.369545
valid_loss: 0.777870
validation finished
Epoch-1 lr: 1e-05
epoch 1 training time: 30.715
---------------
2023-05-11 15:34:24.644038
current #epochs=2, #steps=48
start validation
mAP: 0.072982
AUC: 0.527029
Avg Precision: 0.067315
Avg Recall: 1.000000
d_prime: 0.095889
train_loss: 0.195763
valid_loss: 0.755551
validation finished
Epoch-2 lr: 1e-05
epoch 2 training time: 27.758
---------------
2023-05-11 15:34:52.402167
current #epochs=3, #steps=96
Epoch: [3][4/48]	Per Sample Total Time 0.02963	Per Sample Data Time 0.00591	Per Sample DNN Time 0.02372	Train Loss 0.1756	
start validation
mAP: 0.073753
AUC: 0.537788
Avg Precision: 0.066805
Avg Recall: 1.000000
d_prime: 0.134156
train_loss: 0.171910
valid_loss: 0.744774
validation finished
Epoch-3 lr: 1e-05
epoch 3 training time: 21.580
---------------
2023-05-11 15:35:13.982387
current #epochs=4, #steps=144
start validation
mAP: 0.079316
AUC: 0.543928
Avg Precision: 0.072176
Avg Recall: 1.000000
d_prime: 0.156036
train_loss: 0.158712
valid_loss: 0.737050
validation finished
Epoch-4 lr: 1e-05
epoch 4 training time: 22.279
---------------
2023-05-11 15:35:36.261858
current #epochs=5, #steps=192
Epoch: [5][8/48]	Per Sample Total Time 0.03060	Per Sample Data Time 0.00588	Per Sample DNN Time 0.02472	Train Loss 0.1520	
start validation
mAP: 0.105168
AUC: 0.571792
Avg Precision: 0.091065
Avg Recall: 1.000000
d_prime: 0.255884
train_loss: 0.150555
valid_loss: 0.731480
validation finished
Epoch-5 lr: 8.5e-06
epoch 5 training time: 22.443
---------------
2023-05-11 15:35:58.704263
current #epochs=6, #steps=240
start validation
mAP: 0.092165
AUC: 0.566251
Avg Precision: 0.086054
Avg Recall: 1.000000
d_prime: 0.235944
train_loss: 0.142914
valid_loss: 0.727315
validation finished
Epoch-6 lr: 7.2249999999999994e-06
epoch 6 training time: 19.668
---------------
2023-05-11 15:36:18.372907
current #epochs=7, #steps=288
Epoch: [7][12/48]	Per Sample Total Time 0.02942	Per Sample Data Time 0.00570	Per Sample DNN Time 0.02372	Train Loss 0.1384	
start validation
mAP: 0.098758
AUC: 0.566935
Avg Precision: 0.086983
Avg Recall: 1.000000
d_prime: 0.238401
train_loss: 0.137840
valid_loss: 0.724635
validation finished
Epoch-7 lr: 6.141249999999999e-06
epoch 7 training time: 18.992
---------------
2023-05-11 15:36:37.364588
current #epochs=8, #steps=336
start validation
mAP: 0.093148
AUC: 0.571482
Avg Precision: 0.086556
Avg Recall: 1.000000
d_prime: 0.254768
train_loss: 0.133273
valid_loss: 0.722591
validation finished
Epoch-8 lr: 5.220062499999999e-06
epoch 8 training time: 18.855
---------------
2023-05-11 15:36:56.219246
current #epochs=9, #steps=384
Epoch: [9][16/48]	Per Sample Total Time 0.02929	Per Sample Data Time 0.00558	Per Sample DNN Time 0.02371	Train Loss 0.1349	
start validation
mAP: 0.100091
AUC: 0.561758
Avg Precision: 0.087316
Avg Recall: 1.000000
d_prime: 0.219810
train_loss: 0.131264
valid_loss: 0.720943
validation finished
Epoch-9 lr: 4.4370531249999995e-06
epoch 9 training time: 19.145
---------------
2023-05-11 15:37:15.365147
current #epochs=10, #steps=432
start validation
mAP: 0.100087
AUC: 0.572779
Avg Precision: 0.091345
Avg Recall: 1.000000
d_prime: 0.259443
train_loss: 0.129304
valid_loss: 0.719730
validation finished
Epoch-10 lr: 3.7714951562499997e-06
epoch 10 training time: 18.858
---------------
2023-05-11 15:37:34.222205
current #epochs=11, #steps=480
Epoch: [11][20/48]	Per Sample Total Time 0.02944	Per Sample Data Time 0.00570	Per Sample DNN Time 0.02374	Train Loss 0.1320	
start validation
mAP: 0.103783
AUC: 0.570490
Avg Precision: 0.092100
Avg Recall: 1.000000
d_prime: 0.251195
train_loss: 0.130024
valid_loss: 0.718880
validation finished
Epoch-11 lr: 3.2057708828124997e-06
epoch 11 training time: 19.082
---------------
2023-05-11 15:37:53.305727
current #epochs=12, #steps=528
start validation
mAP: 0.100167
AUC: 0.567917
Avg Precision: 0.090747
Avg Recall: 1.000000
d_prime: 0.241935
train_loss: 0.128471
valid_loss: 0.718159
validation finished
Epoch-12 lr: 2.7249052503906246e-06
epoch 12 training time: 18.961
---------------
2023-05-11 15:38:12.265334
current #epochs=13, #steps=576
Epoch: [13][24/48]	Per Sample Total Time 0.02928	Per Sample Data Time 0.00554	Per Sample DNN Time 0.02373	Train Loss 0.1257	
start validation
mAP: 0.103687
AUC: 0.573042
Avg Precision: 0.094927
Avg Recall: 1.000000
d_prime: 0.260389
train_loss: 0.126582
valid_loss: 0.717465
validation finished
Epoch-13 lr: 2.316169462832031e-06
epoch 13 training time: 18.984
---------------
2023-05-11 15:38:31.249521
current #epochs=14, #steps=624
start validation
mAP: 0.105939
AUC: 0.576587
Avg Precision: 0.094993
Avg Recall: 1.000000
d_prime: 0.273183
train_loss: 0.124299
valid_loss: 0.716997
validation finished
Epoch-14 lr: 1.9687440434072264e-06
epoch 14 training time: 21.854
---------------
2023-05-11 15:38:53.103709
current #epochs=15, #steps=672
Epoch: [15][28/48]	Per Sample Total Time 0.02959	Per Sample Data Time 0.00556	Per Sample DNN Time 0.02403	Train Loss 0.1272	
start validation
mAP: 0.109483
AUC: 0.577088
Avg Precision: 0.096990
Avg Recall: 1.000000
d_prime: 0.274992
train_loss: 0.127001
valid_loss: 0.716586
validation finished
Epoch-15 lr: 1.6734324368961425e-06
epoch 15 training time: 22.531
---------------
2023-05-11 15:39:15.633917
current #epochs=16, #steps=720
start validation
mAP: 0.115099
AUC: 0.579973
Avg Precision: 0.097064
Avg Recall: 1.000000
d_prime: 0.285423
train_loss: 0.124658
valid_loss: 0.716308
validation finished
Epoch-16 lr: 1.422417571361721e-06
epoch 16 training time: 21.686
---------------
2023-05-11 15:39:37.321065
current #epochs=17, #steps=768
Epoch: [17][32/48]	Per Sample Total Time 0.02966	Per Sample Data Time 0.00568	Per Sample DNN Time 0.02398	Train Loss 0.1254	
start validation
mAP: 0.109968
AUC: 0.575238
Avg Precision: 0.096732
Avg Recall: 1.000000
d_prime: 0.268313
train_loss: 0.125821
valid_loss: 0.716032
validation finished
Epoch-17 lr: 1.2090549356574628e-06
epoch 17 training time: 19.139
---------------
2023-05-11 15:39:56.460518
current #epochs=18, #steps=816
start validation
mAP: 0.116019
AUC: 0.579790
Avg Precision: 0.100332
Avg Recall: 1.000000
d_prime: 0.284760
train_loss: 0.125391
valid_loss: 0.715878
validation finished
Epoch-18 lr: 1.0276966953088434e-06
epoch 18 training time: 21.943
---------------
2023-05-11 15:40:18.403537
current #epochs=19, #steps=864
Epoch: [19][36/48]	Per Sample Total Time 0.02936	Per Sample Data Time 0.00559	Per Sample DNN Time 0.02377	Train Loss 0.1256	
start validation
mAP: 0.112935
AUC: 0.578291
Avg Precision: 0.100345
Avg Recall: 1.000000
d_prime: 0.279339
train_loss: 0.125530
valid_loss: 0.715714
validation finished
Epoch-19 lr: 8.735421910125168e-07
epoch 19 training time: 19.099
---------------
2023-05-11 15:40:37.501712
current #epochs=20, #steps=912
start validation
mAP: 0.110175
AUC: 0.577654
Avg Precision: 0.096680
Avg Recall: 1.000000
d_prime: 0.277040
train_loss: 0.125626
valid_loss: 0.715584
validation finished
Epoch-20 lr: 7.425108623606393e-07
epoch 20 training time: 18.883
---------------
2023-05-11 15:40:56.385869
current #epochs=21, #steps=960
Epoch: [21][40/48]	Per Sample Total Time 0.02939	Per Sample Data Time 0.00565	Per Sample DNN Time 0.02374	Train Loss 0.1232	
start validation
mAP: 0.113662
AUC: 0.581350
Avg Precision: 0.100565
Avg Recall: 1.000000
d_prime: 0.290406
train_loss: 0.123481
valid_loss: 0.715431
validation finished
Epoch-21 lr: 6.311342330065434e-07
epoch 21 training time: 19.196
---------------
2023-05-11 15:41:15.581275
current #epochs=22, #steps=1008
start validation
mAP: 0.118404
AUC: 0.582185
Avg Precision: 0.099979
Avg Recall: 1.000000
d_prime: 0.293431
train_loss: 0.122258
valid_loss: 0.715299
validation finished
Epoch-22 lr: 5.364640980555618e-07
epoch 22 training time: 22.752
---------------
2023-05-11 15:41:38.333697
current #epochs=23, #steps=1056
Epoch: [23][44/48]	Per Sample Total Time 0.02940	Per Sample Data Time 0.00565	Per Sample DNN Time 0.02375	Train Loss 0.1243	
start validation
mAP: 0.120464
AUC: 0.580479
Avg Precision: 0.101210
Avg Recall: 1.000000
d_prime: 0.287254
train_loss: 0.124488
valid_loss: 0.715181
validation finished
Epoch-23 lr: 4.5599448334722756e-07
epoch 23 training time: 22.003
---------------
2023-05-11 15:42:00.336695
current #epochs=24, #steps=1104
start validation
mAP: 0.117237
AUC: 0.579512
Avg Precision: 0.100996
Avg Recall: 1.000000
d_prime: 0.283756
train_loss: 0.121500
valid_loss: 0.715076
validation finished
Epoch-24 lr: 3.875953108451434e-07
epoch 24 training time: 19.277
---------------
2023-05-11 15:42:19.613465
current #epochs=25, #steps=1152
start validation
mAP: 0.118918
AUC: 0.575888
Avg Precision: 0.100041
Avg Recall: 1.000000
d_prime: 0.270660
train_loss: 0.121803
valid_loss: 0.714956
validation finished
Epoch-25 lr: 3.294560142183719e-07
epoch 25 training time: 19.136
---------------
2023-05-11 15:42:38.749579
current #epochs=26, #steps=1200
Epoch: [26][0/48]	Per Sample Total Time 0.02963	Per Sample Data Time 0.00533	Per Sample DNN Time 0.02430	Train Loss 0.1258	
start validation
mAP: 0.115778
AUC: 0.581240
Avg Precision: 0.100170
Avg Recall: 1.000000
d_prime: 0.290009
train_loss: 0.124296
valid_loss: 0.714898
validation finished
Epoch-26 lr: 2.800376120856161e-07
epoch 26 training time: 18.909
---------------
2023-05-11 15:42:57.658892
current #epochs=27, #steps=1248
start validation
mAP: 0.121833
AUC: 0.583171
Avg Precision: 0.101117
Avg Recall: 1.000000
d_prime: 0.297004
train_loss: 0.125076
valid_loss: 0.714886
validation finished
Epoch-27 lr: 2.380319702727737e-07
epoch 27 training time: 24.494
---------------
2023-05-11 15:43:22.152902
current #epochs=28, #steps=1296
Epoch: [28][4/48]	Per Sample Total Time 0.02943	Per Sample Data Time 0.00541	Per Sample DNN Time 0.02402	Train Loss 0.1299	
start validation
mAP: 0.119945
AUC: 0.582077
Avg Precision: 0.101187
Avg Recall: 1.000000
d_prime: 0.293038
train_loss: 0.121569
valid_loss: 0.714838
validation finished
Epoch-28 lr: 2.0232717473185765e-07
epoch 28 training time: 18.996
---------------
2023-05-11 15:43:41.149381
current #epochs=29, #steps=1344
start validation
mAP: 0.124232
AUC: 0.583861
Avg Precision: 0.100881
Avg Recall: 1.000000
d_prime: 0.299502
train_loss: 0.123339
valid_loss: 0.714787
validation finished
Epoch-29 lr: 1.71978098522079e-07
epoch 29 training time: 21.692
---------------
2023-05-11 15:44:02.841613
current #epochs=30, #steps=1392
Epoch: [30][8/48]	Per Sample Total Time 0.03011	Per Sample Data Time 0.00569	Per Sample DNN Time 0.02442	Train Loss 0.1210	
start validation
mAP: 0.124306
AUC: 0.579565
Avg Precision: 0.099943
Avg Recall: 1.000000
d_prime: 0.283948
train_loss: 0.123802
valid_loss: 0.714761
validation finished
Epoch-30 lr: 1.4618138374376713e-07
epoch 30 training time: 23.441
---------------Training Finished---------------
weighted averaged model results
mAP: 0.077345
AUC: 0.527919
Avg Precision: 0.071859
Avg Recall: 1.000000
d_prime: 0.099050
train_loss: 0.000000
valid_loss: 0.714761
---------------evaluate on the train, validation, test set---------------
now train a audio spectrogram transformer model
---------------AST Model Summary---------------
ImageNet pretraining: True, AudioSet pretraining: True
frequncey stride=10, time stride=10
number of patches=600
balanced sampler is being used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.600000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
(571, 88)
Traceback (most recent call last):
  File "/research/dept8/fyp22/lj2202/eleg5491/ast/egs/kaggle/../../src/run.py", line 178, in <module>
    evaluate(args.exp_dir)
  File "/research/dept8/fyp22/lj2202/eleg5491/ast/src/eval.py", line 79, in evaluate
    train_auc = sklearn.metrics.roc_auc_score(train_labels.ravel(),train_results.ravel())
  File "/research/dept8/fyp22/lj2202/anaconda3/envs/eleg5491/lib/python3.9/site-packages/sklearn/utils/validation.py", line 63, in inner_f
    return f(*args, **kwargs)
  File "/research/dept8/fyp22/lj2202/anaconda3/envs/eleg5491/lib/python3.9/site-packages/sklearn/metrics/_ranking.py", line 547, in roc_auc_score
    return _average_binary_score(partial(_binary_roc_auc_score,
  File "/research/dept8/fyp22/lj2202/anaconda3/envs/eleg5491/lib/python3.9/site-packages/sklearn/metrics/_base.py", line 74, in _average_binary_score
    raise ValueError("{0} format is not supported".format(y_type))
ValueError: continuous format is not supported
I am process 2879, running on gpu38: starting (Thu May 11 15:44:45 2023)
args:  Namespace(data_train='./data/datafiles/train.json', data_val='./data/datafiles/eval.json', data_eval='./data/datafiles/test.json', label_csv='./data/class_labels_indices.csv', n_class=88, model='ast', dataset='audioset', exp_dir='./exp/ast-attempt10-lr-1e-4', lr=0.0001, optim='adam', batch_size=12, num_workers=0, n_epochs=30, lr_patience=2, n_print_steps=100, save_model=True, freqm=24, timem=96, mixup=0.0, bal='bal', fstride=10, tstride=10, imagenet_pretrain=True, audioset_pretrain=True, dataset_mean=-0.000321335, dataset_std=0.003499322, audio_length=512, noise=False, metrics='mAP', loss='BCE', warmup=False, lrscheduler_start=5, lrscheduler_step=1, lrscheduler_decay=0.85, wa=True, wa_start=1, wa_end=5)
now train a audio spectrogram transformer model
balanced sampler is being used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
---------------AST Model Summary---------------
ImageNet pretraining: True, AudioSet pretraining: True
frequncey stride=10, time stride=10
number of patches=600

Creating experiment directory: ./exp/ast-attempt10-lr-1e-4
Now starting training for 30 epochs
running on cuda
Total parameter number is : 87.324 million
Total trainable parameter number is : 87.324 million
now training with audioset, main metrics: mAP, loss function: BCEWithLogitsLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7fbd9bc3d0a0>
The learning rate scheduler starts at 5 epoch with decay rate of 0.850 every 1 epochs
current #steps=0, #epochs=1
start training...
---------------
2023-05-11 15:44:48.861610
current #epochs=1, #steps=0
start validation
mAP: 0.095055
AUC: 0.558265
Avg Precision: 0.085031
Avg Recall: 1.000000
d_prime: 0.207282
train_loss: 0.185794
valid_loss: 0.712363
validation finished
Epoch-1 lr: 0.0001
epoch 1 training time: 30.092
---------------
2023-05-11 15:45:18.953923
current #epochs=2, #steps=48
start validation
mAP: 0.077634
AUC: 0.528910
Avg Precision: 0.066763
Avg Recall: 1.000000
d_prime: 0.102574
train_loss: 0.128111
valid_loss: 0.710229
validation finished
Epoch-2 lr: 0.0001
epoch 2 training time: 19.911
---------------
2023-05-11 15:45:38.865394
current #epochs=3, #steps=96
Epoch: [3][4/48]	Per Sample Total Time 0.02840	Per Sample Data Time 0.00479	Per Sample DNN Time 0.02360	Train Loss 0.1197	
start validation
mAP: 0.076157
AUC: 0.520870
Avg Precision: 0.067433
Avg Recall: 1.000000
d_prime: 0.074015
train_loss: 0.125232
valid_loss: 0.708257
validation finished
Epoch-3 lr: 0.0001
epoch 3 training time: 18.734
---------------
2023-05-11 15:45:57.599550
current #epochs=4, #steps=144
start validation
mAP: 0.077746
AUC: 0.518266
Avg Precision: 0.068269
Avg Recall: 1.000000
d_prime: 0.064774
train_loss: 0.123170
valid_loss: 0.708388
validation finished
Epoch-4 lr: 0.0001
epoch 4 training time: 18.564
---------------
2023-05-11 15:46:16.163645
current #epochs=5, #steps=192
Epoch: [5][8/48]	Per Sample Total Time 0.02939	Per Sample Data Time 0.00492	Per Sample DNN Time 0.02446	Train Loss 0.1252	
start validation
mAP: 0.076395
AUC: 0.539918
Avg Precision: 0.068508
Avg Recall: 1.000000
d_prime: 0.141743
train_loss: 0.126646
valid_loss: 0.709080
validation finished
Epoch-5 lr: 8.5e-05
epoch 5 training time: 18.940
---------------
2023-05-11 15:46:35.103601
current #epochs=6, #steps=240
start validation
mAP: 0.081417
AUC: 0.544155
Avg Precision: 0.070001
Avg Recall: 1.000000
d_prime: 0.156848
train_loss: 0.123763
valid_loss: 0.709443
validation finished
Epoch-6 lr: 7.225000000000001e-05
epoch 6 training time: 18.863
---------------
2023-05-11 15:46:53.966742
current #epochs=7, #steps=288
Epoch: [7][12/48]	Per Sample Total Time 0.02861	Per Sample Data Time 0.00502	Per Sample DNN Time 0.02359	Train Loss 0.1243	
start validation
mAP: 0.086853
AUC: 0.547479
Avg Precision: 0.073464
Avg Recall: 1.000000
d_prime: 0.168708
train_loss: 0.121648
valid_loss: 0.709908
validation finished
Epoch-7 lr: 6.141250000000001e-05
epoch 7 training time: 18.551
---------------
2023-05-11 15:47:12.517431
current #epochs=8, #steps=336
start validation
mAP: 0.083342
AUC: 0.546570
Avg Precision: 0.072329
Avg Recall: 1.000000
d_prime: 0.165463
train_loss: 0.123749
valid_loss: 0.709116
validation finished
Epoch-8 lr: 5.2200625000000005e-05
epoch 8 training time: 18.442
---------------
2023-05-11 15:47:30.960619
current #epochs=9, #steps=384
Epoch: [9][16/48]	Per Sample Total Time 0.02860	Per Sample Data Time 0.00493	Per Sample DNN Time 0.02367	Train Loss 0.1254	
start validation
mAP: 0.080491
AUC: 0.550242
Avg Precision: 0.068739
Avg Recall: 1.000000
d_prime: 0.178576
train_loss: 0.126137
valid_loss: 0.709730
validation finished
Epoch-9 lr: 4.437053125e-05
epoch 9 training time: 18.421
---------------
2023-05-11 15:47:49.381064
current #epochs=10, #steps=432
start validation
mAP: 0.092596
AUC: 0.547198
Avg Precision: 0.076379
Avg Recall: 1.000000
d_prime: 0.167706
train_loss: 0.122284
valid_loss: 0.709745
validation finished
Epoch-10 lr: 3.77149515625e-05
epoch 10 training time: 18.396
---------------
2023-05-11 15:48:07.777544
current #epochs=11, #steps=480
Epoch: [11][20/48]	Per Sample Total Time 0.02855	Per Sample Data Time 0.00489	Per Sample DNN Time 0.02366	Train Loss 0.1250	
start validation
mAP: 0.086076
AUC: 0.538399
Avg Precision: 0.073618
Avg Recall: 1.000000
d_prime: 0.136331
train_loss: 0.123005
valid_loss: 0.708982
validation finished
Epoch-11 lr: 3.2057708828124995e-05
epoch 11 training time: 18.548
---------------
2023-05-11 15:48:26.325232
current #epochs=12, #steps=528
start validation
mAP: 0.095146
AUC: 0.569867
Avg Precision: 0.084295
Avg Recall: 1.000000
d_prime: 0.248953
train_loss: 0.121638
valid_loss: 0.708828
validation finished
Epoch-12 lr: 2.7249052503906245e-05
epoch 12 training time: 21.946
---------------
2023-05-11 15:48:48.272187
current #epochs=13, #steps=576
Epoch: [13][24/48]	Per Sample Total Time 0.02901	Per Sample Data Time 0.00492	Per Sample DNN Time 0.02409	Train Loss 0.1221	
start validation
mAP: 0.117080
AUC: 0.566496
Avg Precision: 0.102074
Avg Recall: 1.000000
d_prime: 0.236826
train_loss: 0.120722
valid_loss: 0.708424
validation finished
Epoch-13 lr: 2.3161694628320308e-05
epoch 13 training time: 21.498
---------------
2023-05-11 15:49:09.769092
current #epochs=14, #steps=624
start validation
mAP: 0.133474
AUC: 0.575948
Avg Precision: 0.112418
Avg Recall: 1.000000
d_prime: 0.270875
train_loss: 0.122512
valid_loss: 0.709436
validation finished
Epoch-14 lr: 1.9687440434072263e-05
epoch 14 training time: 21.345
---------------
2023-05-11 15:49:31.114118
current #epochs=15, #steps=672
Epoch: [15][28/48]	Per Sample Total Time 0.02847	Per Sample Data Time 0.00485	Per Sample DNN Time 0.02362	Train Loss 0.1206	
start validation
mAP: 0.128281
AUC: 0.578937
Avg Precision: 0.109143
Avg Recall: 1.000000
d_prime: 0.281677
train_loss: 0.121033
valid_loss: 0.709615
validation finished
Epoch-15 lr: 1.673432436896142e-05
epoch 15 training time: 18.642
---------------
2023-05-11 15:49:49.756535
current #epochs=16, #steps=720
start validation
mAP: 0.114124
AUC: 0.559301
Avg Precision: 0.096552
Avg Recall: 1.000000
d_prime: 0.210997
train_loss: 0.121632
valid_loss: 0.708410
validation finished
Epoch-16 lr: 1.4224175713617208e-05
epoch 16 training time: 18.599
---------------
2023-05-11 15:50:08.356491
current #epochs=17, #steps=768
Epoch: [17][32/48]	Per Sample Total Time 0.02877	Per Sample Data Time 0.00484	Per Sample DNN Time 0.02393	Train Loss 0.1204	
start validation
mAP: 0.131407
AUC: 0.561675
Avg Precision: 0.111178
Avg Recall: 1.000000
d_prime: 0.219512
train_loss: 0.120534
valid_loss: 0.709760
validation finished
Epoch-17 lr: 1.2090549356574626e-05
epoch 17 training time: 18.447
---------------
2023-05-11 15:50:26.804185
current #epochs=18, #steps=816
start validation
mAP: 0.111199
AUC: 0.566099
Avg Precision: 0.086151
Avg Recall: 1.000000
d_prime: 0.235397
train_loss: 0.119386
valid_loss: 0.708860
validation finished
Epoch-18 lr: 1.0276966953088432e-05
epoch 18 training time: 19.328
---------------
2023-05-11 15:50:46.132411
current #epochs=19, #steps=864
Epoch: [19][36/48]	Per Sample Total Time 0.02877	Per Sample Data Time 0.00492	Per Sample DNN Time 0.02385	Train Loss 0.1185	
start validation
mAP: 0.141736
AUC: 0.569334
Avg Precision: 0.117918
Avg Recall: 1.000000
d_prime: 0.247032
train_loss: 0.119696
valid_loss: 0.708363
validation finished
Epoch-19 lr: 8.735421910125167e-06
epoch 19 training time: 22.174
---------------
2023-05-11 15:51:08.305654
current #epochs=20, #steps=912
start validation
mAP: 0.130755
AUC: 0.578442
Avg Precision: 0.111795
Avg Recall: 1.000000
d_prime: 0.279885
train_loss: 0.120247
valid_loss: 0.709051
validation finished
Epoch-20 lr: 7.425108623606392e-06
epoch 20 training time: 18.632
---------------
2023-05-11 15:51:26.938855
current #epochs=21, #steps=960
Epoch: [21][40/48]	Per Sample Total Time 0.02865	Per Sample Data Time 0.00486	Per Sample DNN Time 0.02379	Train Loss 0.1195	
start validation
mAP: 0.123194
AUC: 0.550302
Avg Precision: 0.104169
Avg Recall: 1.000000
d_prime: 0.178792
train_loss: 0.120113
valid_loss: 0.709132
validation finished
Epoch-21 lr: 6.3113423300654325e-06
epoch 21 training time: 19.192
---------------
2023-05-11 15:51:46.130978
current #epochs=22, #steps=1008
start validation
mAP: 0.134463
AUC: 0.566989
Avg Precision: 0.110912
Avg Recall: 1.000000
d_prime: 0.238598
train_loss: 0.121486
valid_loss: 0.709008
validation finished
Epoch-22 lr: 5.3646409805556175e-06
epoch 22 training time: 18.520
---------------
2023-05-11 15:52:04.650951
current #epochs=23, #steps=1056
Epoch: [23][44/48]	Per Sample Total Time 0.02855	Per Sample Data Time 0.00489	Per Sample DNN Time 0.02366	Train Loss 0.1219	
start validation
mAP: 0.123646
AUC: 0.563098
Avg Precision: 0.102284
Avg Recall: 1.000000
d_prime: 0.224618
train_loss: 0.122045
valid_loss: 0.709278
validation finished
Epoch-23 lr: 4.559944833472275e-06
epoch 23 training time: 18.426
---------------
2023-05-11 15:52:23.075766
current #epochs=24, #steps=1104
start validation
mAP: 0.132048
AUC: 0.567784
Avg Precision: 0.112675
Avg Recall: 1.000000
d_prime: 0.241455
train_loss: 0.120928
valid_loss: 0.709272
validation finished
Epoch-24 lr: 3.875953108451433e-06
epoch 24 training time: 18.489
---------------
2023-05-11 15:52:41.564343
current #epochs=25, #steps=1152
start validation
mAP: 0.124369
AUC: 0.563067
Avg Precision: 0.108582
Avg Recall: 1.000000
d_prime: 0.224505
train_loss: 0.119914
valid_loss: 0.709081
validation finished
Epoch-25 lr: 3.2945601421837183e-06
epoch 25 training time: 18.424
---------------
2023-05-11 15:52:59.989599
current #epochs=26, #steps=1200
Epoch: [26][0/48]	Per Sample Total Time 0.02965	Per Sample Data Time 0.00550	Per Sample DNN Time 0.02415	Train Loss 0.1120	
start validation
mAP: 0.126885
AUC: 0.580227
Avg Precision: 0.108252
Avg Recall: 1.000000
d_prime: 0.286342
train_loss: 0.120944
valid_loss: 0.709227
validation finished
Epoch-26 lr: 2.8003761208561607e-06
epoch 26 training time: 18.513
---------------
2023-05-11 15:53:18.503035
current #epochs=27, #steps=1248
start validation
mAP: 0.115556
AUC: 0.568561
Avg Precision: 0.098193
Avg Recall: 1.000000
d_prime: 0.244251
train_loss: 0.120783
valid_loss: 0.709104
validation finished
Epoch-27 lr: 2.3803197027277364e-06
epoch 27 training time: 18.441
---------------
2023-05-11 15:53:36.944486
current #epochs=28, #steps=1296
Epoch: [28][4/48]	Per Sample Total Time 0.02852	Per Sample Data Time 0.00500	Per Sample DNN Time 0.02352	Train Loss 0.1090	
start validation
mAP: 0.117841
AUC: 0.575314
Avg Precision: 0.097794
Avg Recall: 1.000000
d_prime: 0.268586
train_loss: 0.117583
valid_loss: 0.708983
validation finished
Epoch-28 lr: 2.0232717473185757e-06
epoch 28 training time: 18.469
---------------
2023-05-11 15:53:55.412185
current #epochs=29, #steps=1344
start validation
mAP: 0.117607
AUC: 0.566073
Avg Precision: 0.098544
Avg Recall: 1.000000
d_prime: 0.235303
train_loss: 0.119231
valid_loss: 0.708911
validation finished
Epoch-29 lr: 1.7197809852207893e-06
epoch 29 training time: 18.459
---------------
2023-05-11 15:54:13.870396
current #epochs=30, #steps=1392
Epoch: [30][8/48]	Per Sample Total Time 0.02862	Per Sample Data Time 0.00482	Per Sample DNN Time 0.02380	Train Loss 0.1183	
start validation
mAP: 0.129863
AUC: 0.578738
Avg Precision: 0.106202
Avg Recall: 1.000000
d_prime: 0.280954
train_loss: 0.118554
valid_loss: 0.708838
validation finished
Epoch-30 lr: 1.4618138374376709e-06
epoch 30 training time: 18.443
---------------Training Finished---------------
weighted averaged model results
mAP: 0.083309
AUC: 0.533802
Avg Precision: 0.068860
Avg Recall: 1.000000
d_prime: 0.119968
train_loss: 0.000000
valid_loss: 0.708838
---------------evaluate on the train, validation, test set---------------
now train a audio spectrogram transformer model
---------------AST Model Summary---------------
ImageNet pretraining: True, AudioSet pretraining: True
frequncey stride=10, time stride=10
number of patches=600
balanced sampler is being used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
(571, 88)
train auc:  0.7513808107914858
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
(68, 88)
val auc:  0.5991318343657026
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
(48, 88)
eval auc:  0.5783310103746333
I am process 9555, running on gpu38: starting (Thu May 11 15:54:53 2023)
args:  Namespace(data_train='./data/datafiles/train.json', data_val='./data/datafiles/eval.json', data_eval='./data/datafiles/test.json', label_csv='./data/class_labels_indices.csv', n_class=88, model='ast', dataset='audioset', exp_dir='./exp/ast-attempt11-lr-1e-6', lr=1e-06, optim='adam', batch_size=12, num_workers=0, n_epochs=50, lr_patience=2, n_print_steps=100, save_model=True, freqm=24, timem=96, mixup=0.0, bal='bal', fstride=10, tstride=10, imagenet_pretrain=True, audioset_pretrain=True, dataset_mean=-0.000321335, dataset_std=0.003499322, audio_length=512, noise=False, metrics='mAP', loss='BCE', warmup=False, lrscheduler_start=5, lrscheduler_step=1, lrscheduler_decay=0.85, wa=True, wa_start=1, wa_end=5)
now train a audio spectrogram transformer model
balanced sampler is being used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
---------------AST Model Summary---------------
ImageNet pretraining: True, AudioSet pretraining: True
frequncey stride=10, time stride=10
number of patches=600

Creating experiment directory: ./exp/ast-attempt11-lr-1e-6
Now starting training for 50 epochs
running on cuda
Total parameter number is : 87.324 million
Total trainable parameter number is : 87.324 million
now training with audioset, main metrics: mAP, loss function: BCEWithLogitsLoss(), learning rate scheduler: <torch.optim.lr_scheduler.MultiStepLR object at 0x7f3e6c1f9910>
The learning rate scheduler starts at 5 epoch with decay rate of 0.850 every 1 epochs
current #steps=0, #epochs=1
start training...
---------------
2023-05-11 15:54:56.443742
current #epochs=1, #steps=0
start validation
mAP: 0.087659
AUC: 0.507113
Avg Precision: 0.076131
Avg Recall: 1.000000
d_prime: 0.025216
train_loss: 0.680498
valid_loss: 0.930421
validation finished
Epoch-1 lr: 1e-06
epoch 1 training time: 30.053
---------------
2023-05-11 15:55:26.497679
current #epochs=2, #steps=48
start validation
mAP: 0.098823
AUC: 0.490294
Avg Precision: 0.089872
Avg Recall: 1.000000
d_prime: -0.034412
train_loss: 0.555921
valid_loss: 0.892049
validation finished
Epoch-2 lr: 1e-06
epoch 2 training time: 23.193
---------------
2023-05-11 15:55:49.692064
current #epochs=3, #steps=96
Epoch: [3][4/48]	Per Sample Total Time 0.02884	Per Sample Data Time 0.00524	Per Sample DNN Time 0.02359	Train Loss 0.4860	
start validation
mAP: 0.095641
AUC: 0.503380
Avg Precision: 0.087876
Avg Recall: 1.000000
d_prime: 0.011983
train_loss: 0.439645
valid_loss: 0.855953
validation finished
Epoch-3 lr: 1e-06
epoch 3 training time: 18.779
---------------
2023-05-11 15:56:08.471111
current #epochs=4, #steps=144
start validation
mAP: 0.094342
AUC: 0.477235
Avg Precision: 0.091768
Avg Recall: 1.000000
d_prime: -0.080743
train_loss: 0.343074
valid_loss: 0.827828
validation finished
Epoch-4 lr: 1e-06
epoch 4 training time: 18.934
---------------
2023-05-11 15:56:27.404024
current #epochs=5, #steps=192
Epoch: [5][8/48]	Per Sample Total Time 0.02945	Per Sample Data Time 0.00493	Per Sample DNN Time 0.02453	Train Loss 0.2963	
start validation
mAP: 0.076165
AUC: 0.477233
Avg Precision: 0.073589
Avg Recall: 1.000000
d_prime: -0.080751
train_loss: 0.281520
valid_loss: 0.809798
validation finished
Epoch-5 lr: 8.499999999999999e-07
epoch 5 training time: 18.639
---------------
2023-05-11 15:56:46.044493
current #epochs=6, #steps=240
start validation
mAP: 0.077607
AUC: 0.482559
Avg Precision: 0.074874
Avg Recall: 1.000000
d_prime: -0.061848
train_loss: 0.253040
valid_loss: 0.800199
validation finished
Epoch-6 lr: 7.224999999999999e-07
epoch 6 training time: 19.143
---------------
2023-05-11 15:57:05.187762
current #epochs=7, #steps=288
Epoch: [7][12/48]	Per Sample Total Time 0.02864	Per Sample Data Time 0.00500	Per Sample DNN Time 0.02364	Train Loss 0.2370	
start validation
mAP: 0.077598
AUC: 0.479909
Avg Precision: 0.074449
Avg Recall: 1.000000
d_prime: -0.071249
train_loss: 0.237548
valid_loss: 0.794085
validation finished
Epoch-7 lr: 6.141249999999998e-07
epoch 7 training time: 20.031
---------------
2023-05-11 15:57:25.217406
current #epochs=8, #steps=336
start validation
mAP: 0.084155
AUC: 0.499680
Avg Precision: 0.074623
Avg Recall: 1.000000
d_prime: -0.001133
train_loss: 0.234567
valid_loss: 0.789951
validation finished
Epoch-8 lr: 5.220062499999998e-07
epoch 8 training time: 18.368
---------------
2023-05-11 15:57:43.585478
current #epochs=9, #steps=384
Epoch: [9][16/48]	Per Sample Total Time 0.02849	Per Sample Data Time 0.00479	Per Sample DNN Time 0.02369	Train Loss 0.2255	
start validation
mAP: 0.082960
AUC: 0.491000
Avg Precision: 0.072890
Avg Recall: 1.000000
d_prime: -0.031908
train_loss: 0.225282
valid_loss: 0.787223
validation finished
Epoch-9 lr: 4.437053124999999e-07
epoch 9 training time: 18.371
---------------
2023-05-11 15:58:01.957787
current #epochs=10, #steps=432
start validation
mAP: 0.083868
AUC: 0.497448
Avg Precision: 0.073267
Avg Recall: 1.000000
d_prime: -0.009048
train_loss: 0.222432
valid_loss: 0.784961
validation finished
Epoch-10 lr: 3.771495156249999e-07
epoch 10 training time: 18.431
---------------
2023-05-11 15:58:20.388573
current #epochs=11, #steps=480
Epoch: [11][20/48]	Per Sample Total Time 0.02873	Per Sample Data Time 0.00500	Per Sample DNN Time 0.02373	Train Loss 0.2204	
start validation
mAP: 0.085114
AUC: 0.496128
Avg Precision: 0.075239
Avg Recall: 1.000000
d_prime: -0.013727
train_loss: 0.219668
valid_loss: 0.783244
validation finished
Epoch-11 lr: 3.205770882812499e-07
epoch 11 training time: 18.493
---------------
2023-05-11 15:58:38.880698
current #epochs=12, #steps=528
start validation
mAP: 0.085047
AUC: 0.496461
Avg Precision: 0.074536
Avg Recall: 1.000000
d_prime: -0.012547
train_loss: 0.218868
valid_loss: 0.781860
validation finished
Epoch-12 lr: 2.724905250390624e-07
epoch 12 training time: 18.401
---------------
2023-05-11 15:58:57.281785
current #epochs=13, #steps=576
Epoch: [13][24/48]	Per Sample Total Time 0.02858	Per Sample Data Time 0.00494	Per Sample DNN Time 0.02364	Train Loss 0.2176	
start validation
mAP: 0.085462
AUC: 0.497063
Avg Precision: 0.074990
Avg Recall: 1.000000
d_prime: -0.010411
train_loss: 0.216328
valid_loss: 0.780826
validation finished
Epoch-13 lr: 2.3161694628320302e-07
epoch 13 training time: 18.717
---------------
2023-05-11 15:59:15.998061
current #epochs=14, #steps=624
start validation
mAP: 0.083998
AUC: 0.498189
Avg Precision: 0.072663
Avg Recall: 1.000000
d_prime: -0.006421
train_loss: 0.216481
valid_loss: 0.779941
validation finished
Epoch-14 lr: 1.9687440434072255e-07
epoch 14 training time: 18.406
---------------
2023-05-11 15:59:34.404820
current #epochs=15, #steps=672
Epoch: [15][28/48]	Per Sample Total Time 0.02854	Per Sample Data Time 0.00488	Per Sample DNN Time 0.02366	Train Loss 0.2128	
start validation
mAP: 0.086339
AUC: 0.500001
Avg Precision: 0.075246
Avg Recall: 1.000000
d_prime: 0.000003
train_loss: 0.212096
valid_loss: 0.779262
validation finished
Epoch-15 lr: 1.6734324368961418e-07
epoch 15 training time: 18.430
---------------
2023-05-11 15:59:52.835153
current #epochs=16, #steps=720
start validation
mAP: 0.083518
AUC: 0.498918
Avg Precision: 0.072507
Avg Recall: 1.000000
d_prime: -0.003837
train_loss: 0.214761
valid_loss: 0.778685
validation finished
Epoch-16 lr: 1.4224175713617204e-07
epoch 16 training time: 18.396
---------------
2023-05-11 16:00:11.230011
current #epochs=17, #steps=768
Epoch: [17][32/48]	Per Sample Total Time 0.02857	Per Sample Data Time 0.00489	Per Sample DNN Time 0.02368	Train Loss 0.2138	
start validation
mAP: 0.083352
AUC: 0.496595
Avg Precision: 0.072144
Avg Recall: 1.000000
d_prime: -0.012072
train_loss: 0.212572
valid_loss: 0.778149
validation finished
Epoch-17 lr: 1.2090549356574622e-07
epoch 17 training time: 18.453
---------------
2023-05-11 16:00:29.682828
current #epochs=18, #steps=816
start validation
mAP: 0.082906
AUC: 0.497065
Avg Precision: 0.071522
Avg Recall: 1.000000
d_prime: -0.010403
train_loss: 0.210122
valid_loss: 0.777768
validation finished
Epoch-18 lr: 1.0276966953088428e-07
epoch 18 training time: 18.782
---------------
2023-05-11 16:00:48.464678
current #epochs=19, #steps=864
Epoch: [19][36/48]	Per Sample Total Time 0.02853	Per Sample Data Time 0.00488	Per Sample DNN Time 0.02365	Train Loss 0.2116	
start validation
mAP: 0.082597
AUC: 0.498221
Avg Precision: 0.072285
Avg Recall: 1.000000
d_prime: -0.006307
train_loss: 0.211618
valid_loss: 0.777444
validation finished
Epoch-19 lr: 8.735421910125163e-08
epoch 19 training time: 18.505
---------------
2023-05-11 16:01:06.969531
current #epochs=20, #steps=912
start validation
mAP: 0.082688
AUC: 0.499417
Avg Precision: 0.071743
Avg Recall: 1.000000
d_prime: -0.002066
train_loss: 0.210347
valid_loss: 0.777151
validation finished
Epoch-20 lr: 7.425108623606389e-08
epoch 20 training time: 20.376
---------------
2023-05-11 16:01:27.345753
current #epochs=21, #steps=960
Epoch: [21][40/48]	Per Sample Total Time 0.02851	Per Sample Data Time 0.00481	Per Sample DNN Time 0.02370	Train Loss 0.2090	
start validation
mAP: 0.082105
AUC: 0.498496
Avg Precision: 0.071044
Avg Recall: 1.000000
d_prime: -0.005332
train_loss: 0.209314
valid_loss: 0.776906
validation finished
Epoch-21 lr: 6.311342330065431e-08
epoch 21 training time: 18.413
---------------
2023-05-11 16:01:45.759092
current #epochs=22, #steps=1008
start validation
mAP: 0.085700
AUC: 0.499220
Avg Precision: 0.075300
Avg Recall: 1.000000
d_prime: -0.002764
train_loss: 0.210847
valid_loss: 0.776709
validation finished
Epoch-22 lr: 5.364640980555616e-08
epoch 22 training time: 18.352
---------------
2023-05-11 16:02:04.111039
current #epochs=23, #steps=1056
Epoch: [23][44/48]	Per Sample Total Time 0.02852	Per Sample Data Time 0.00488	Per Sample DNN Time 0.02364	Train Loss 0.2115	
start validation
mAP: 0.083388
AUC: 0.499319
Avg Precision: 0.072361
Avg Recall: 1.000000
d_prime: -0.002414
train_loss: 0.211626
valid_loss: 0.776515
validation finished
Epoch-23 lr: 4.559944833472274e-08
epoch 23 training time: 18.398
---------------
2023-05-11 16:02:22.509499
current #epochs=24, #steps=1104
start validation
mAP: 0.083744
AUC: 0.497906
Avg Precision: 0.073211
Avg Recall: 1.000000
d_prime: -0.007423
train_loss: 0.209396
valid_loss: 0.776361
validation finished
Epoch-24 lr: 3.8759531084514324e-08
epoch 24 training time: 18.359
---------------
2023-05-11 16:02:40.867986
current #epochs=25, #steps=1152
start validation
mAP: 0.084096
AUC: 0.499957
Avg Precision: 0.073366
Avg Recall: 1.000000
d_prime: -0.000153
train_loss: 0.210390
valid_loss: 0.776227
validation finished
Epoch-25 lr: 3.2945601421837176e-08
epoch 25 training time: 18.360
---------------
2023-05-11 16:02:59.228805
current #epochs=26, #steps=1200
Epoch: [26][0/48]	Per Sample Total Time 0.02839	Per Sample Data Time 0.00467	Per Sample DNN Time 0.02372	Train Loss 0.2158	
start validation
mAP: 0.083338
AUC: 0.500233
Avg Precision: 0.073197
Avg Recall: 1.000000
d_prime: 0.000826
train_loss: 0.210812
valid_loss: 0.776124
validation finished
Epoch-26 lr: 2.8003761208561598e-08
epoch 26 training time: 18.386
---------------
2023-05-11 16:03:17.614768
current #epochs=27, #steps=1248
start validation
mAP: 0.085174
AUC: 0.501036
Avg Precision: 0.073801
Avg Recall: 1.000000
d_prime: 0.003674
train_loss: 0.210221
valid_loss: 0.776012
validation finished
Epoch-27 lr: 2.3803197027277357e-08
epoch 27 training time: 18.382
---------------
2023-05-11 16:03:35.996415
current #epochs=28, #steps=1296
Epoch: [28][4/48]	Per Sample Total Time 0.02856	Per Sample Data Time 0.00496	Per Sample DNN Time 0.02360	Train Loss 0.2141	
start validation
mAP: 0.083198
AUC: 0.501101
Avg Precision: 0.072575
Avg Recall: 1.000000
d_prime: 0.003905
train_loss: 0.208666
valid_loss: 0.775920
validation finished
Epoch-28 lr: 2.0232717473185753e-08
epoch 28 training time: 19.254
---------------
2023-05-11 16:03:55.250304
current #epochs=29, #steps=1344
start validation
mAP: 0.083381
AUC: 0.499361
Avg Precision: 0.072919
Avg Recall: 1.000000
d_prime: -0.002265
train_loss: 0.208581
valid_loss: 0.775862
validation finished
Epoch-29 lr: 1.719780985220789e-08
epoch 29 training time: 18.482
---------------
2023-05-11 16:04:13.733688
current #epochs=30, #steps=1392
Epoch: [30][8/48]	Per Sample Total Time 0.02875	Per Sample Data Time 0.00498	Per Sample DNN Time 0.02378	Train Loss 0.2116	
start validation
mAP: 0.082403
AUC: 0.501213
Avg Precision: 0.071782
Avg Recall: 1.000000
d_prime: 0.004301
train_loss: 0.212504
valid_loss: 0.775805
validation finished
Epoch-30 lr: 1.4618138374376706e-08
epoch 30 training time: 19.292
---------------
2023-05-11 16:04:33.025717
current #epochs=31, #steps=1440
start validation
mAP: 0.084440
AUC: 0.500842
Avg Precision: 0.073278
Avg Recall: 1.000000
d_prime: 0.002986
train_loss: 0.210633
valid_loss: 0.775750
validation finished
Epoch-31 lr: 1.24254176182202e-08
epoch 31 training time: 18.431
---------------
2023-05-11 16:04:51.456402
current #epochs=32, #steps=1488
Epoch: [32][12/48]	Per Sample Total Time 0.02856	Per Sample Data Time 0.00491	Per Sample DNN Time 0.02364	Train Loss 0.2075	
start validation
mAP: 0.085870
AUC: 0.499391
Avg Precision: 0.075993
Avg Recall: 1.000000
d_prime: -0.002158
train_loss: 0.210748
valid_loss: 0.775711
validation finished
Epoch-32 lr: 1.056160497548717e-08
epoch 32 training time: 18.524
---------------
2023-05-11 16:05:09.979601
current #epochs=33, #steps=1536
start validation
mAP: 0.086883
AUC: 0.502818
Avg Precision: 0.076245
Avg Recall: 1.000000
d_prime: 0.009991
train_loss: 0.207918
valid_loss: 0.775674
validation finished
Epoch-33 lr: 8.977364229164094e-09
epoch 33 training time: 18.736
---------------
2023-05-11 16:05:28.716378
current #epochs=34, #steps=1584
Epoch: [34][16/48]	Per Sample Total Time 0.02854	Per Sample Data Time 0.00487	Per Sample DNN Time 0.02367	Train Loss 0.2061	
start validation
mAP: 0.085567
AUC: 0.499898
Avg Precision: 0.075154
Avg Recall: 1.000000
d_prime: -0.000360
train_loss: 0.208856
valid_loss: 0.775641
validation finished
Epoch-34 lr: 7.63075959478948e-09
epoch 34 training time: 18.371
---------------
2023-05-11 16:05:47.086399
current #epochs=35, #steps=1632
start validation
mAP: 0.083640
AUC: 0.500617
Avg Precision: 0.073032
Avg Recall: 1.000000
d_prime: 0.002189
train_loss: 0.210549
valid_loss: 0.775615
validation finished
Epoch-35 lr: 6.486145655571058e-09
epoch 35 training time: 18.569
---------------
2023-05-11 16:06:05.655573
current #epochs=36, #steps=1680
Epoch: [36][20/48]	Per Sample Total Time 0.02855	Per Sample Data Time 0.00487	Per Sample DNN Time 0.02368	Train Loss 0.2086	
start validation
mAP: 0.083785
AUC: 0.502337
Avg Precision: 0.073578
Avg Recall: 1.000000
d_prime: 0.008285
train_loss: 0.209629
valid_loss: 0.775599
validation finished
Epoch-36 lr: 5.5132238072354e-09
epoch 36 training time: 18.435
---------------
2023-05-11 16:06:24.092010
current #epochs=37, #steps=1728
start validation
mAP: 0.085730
AUC: 0.500734
Avg Precision: 0.075656
Avg Recall: 1.000000
d_prime: 0.002603
train_loss: 0.210692
valid_loss: 0.775582
validation finished
Epoch-37 lr: 4.68624023615009e-09
epoch 37 training time: 18.449
---------------
2023-05-11 16:06:42.540444
current #epochs=38, #steps=1776
Epoch: [38][24/48]	Per Sample Total Time 0.02862	Per Sample Data Time 0.00497	Per Sample DNN Time 0.02365	Train Loss 0.2102	
start validation
mAP: 0.082957
AUC: 0.501550
Avg Precision: 0.073395
Avg Recall: 1.000000
d_prime: 0.005496
train_loss: 0.210020
valid_loss: 0.775569
validation finished
Epoch-38 lr: 3.983304200727577e-09
epoch 38 training time: 18.341
---------------
2023-05-11 16:07:00.880874
current #epochs=39, #steps=1824
start validation
mAP: 0.085466
AUC: 0.500940
Avg Precision: 0.075258
Avg Recall: 1.000000
d_prime: 0.003333
train_loss: 0.208465
valid_loss: 0.775553
validation finished
Epoch-39 lr: 3.38580857061844e-09
epoch 39 training time: 18.392
---------------
2023-05-11 16:07:19.273315
current #epochs=40, #steps=1872
Epoch: [40][28/48]	Per Sample Total Time 0.02844	Per Sample Data Time 0.00479	Per Sample DNN Time 0.02366	Train Loss 0.2080	
start validation
mAP: 0.083032
AUC: 0.499497
Avg Precision: 0.071931
Avg Recall: 1.000000
d_prime: -0.001784
train_loss: 0.208314
valid_loss: 0.775541
validation finished
Epoch-40 lr: 2.877937285025674e-09
epoch 40 training time: 18.432
---------------
2023-05-11 16:07:37.705635
current #epochs=41, #steps=1920
start validation
mAP: 0.083534
AUC: 0.500502
Avg Precision: 0.073052
Avg Recall: 1.000000
d_prime: 0.001779
train_loss: 0.208274
valid_loss: 0.775533
validation finished
Epoch-41 lr: 2.446246692271823e-09
epoch 41 training time: 18.453
---------------
2023-05-11 16:07:56.158426
current #epochs=42, #steps=1968
Epoch: [42][32/48]	Per Sample Total Time 0.02884	Per Sample Data Time 0.00511	Per Sample DNN Time 0.02374	Train Loss 0.2081	
start validation
mAP: 0.083253
AUC: 0.500982
Avg Precision: 0.073362
Avg Recall: 1.000000
d_prime: 0.003482
train_loss: 0.208712
valid_loss: 0.775527
validation finished
Epoch-42 lr: 2.0793096884310493e-09
epoch 42 training time: 18.538
---------------
2023-05-11 16:08:14.696693
current #epochs=43, #steps=2016
start validation
mAP: 0.083347
AUC: 0.499774
Avg Precision: 0.072830
Avg Recall: 1.000000
d_prime: -0.000802
train_loss: 0.208935
valid_loss: 0.775518
validation finished
Epoch-43 lr: 1.7674132351663918e-09
epoch 43 training time: 18.670
---------------
2023-05-11 16:08:33.366443
current #epochs=44, #steps=2064
Epoch: [44][36/48]	Per Sample Total Time 0.02864	Per Sample Data Time 0.00492	Per Sample DNN Time 0.02371	Train Loss 0.2093	
start validation
mAP: 0.085701
AUC: 0.501651
Avg Precision: 0.075509
Avg Recall: 1.000000
d_prime: 0.005852
train_loss: 0.209197
valid_loss: 0.775513
validation finished
Epoch-44 lr: 1.502301249891433e-09
epoch 44 training time: 18.453
---------------
2023-05-11 16:08:51.820802
current #epochs=45, #steps=2112
start validation
mAP: 0.086036
AUC: 0.502014
Avg Precision: 0.075690
Avg Recall: 1.000000
d_prime: 0.007139
train_loss: 0.207909
valid_loss: 0.775509
validation finished
Epoch-45 lr: 1.276956062407718e-09
epoch 45 training time: 18.470
---------------
2023-05-11 16:09:10.291167
current #epochs=46, #steps=2160
Epoch: [46][40/48]	Per Sample Total Time 0.02858	Per Sample Data Time 0.00489	Per Sample DNN Time 0.02369	Train Loss 0.2104	
start validation
mAP: 0.086042
AUC: 0.501035
Avg Precision: 0.075828
Avg Recall: 1.000000
d_prime: 0.003670
train_loss: 0.210811
valid_loss: 0.775502
validation finished
Epoch-46 lr: 1.0854126530465603e-09
epoch 46 training time: 18.465
---------------
2023-05-11 16:09:28.755278
current #epochs=47, #steps=2208
start validation
mAP: 0.086358
AUC: 0.502249
Avg Precision: 0.075382
Avg Recall: 1.000000
d_prime: 0.007974
train_loss: 0.209208
valid_loss: 0.775501
validation finished
Epoch-47 lr: 9.226007550895762e-10
epoch 47 training time: 18.578
---------------
2023-05-11 16:09:47.332892
current #epochs=48, #steps=2256
Epoch: [48][44/48]	Per Sample Total Time 0.02859	Per Sample Data Time 0.00486	Per Sample DNN Time 0.02373	Train Loss 0.2075	
start validation
mAP: 0.085874
AUC: 0.502649
Avg Precision: 0.076069
Avg Recall: 1.000000
d_prime: 0.009391
train_loss: 0.207568
valid_loss: 0.775500
validation finished
Epoch-48 lr: 7.842106418261397e-10
epoch 48 training time: 18.505
---------------
2023-05-11 16:10:05.838575
current #epochs=49, #steps=2304
start validation
mAP: 0.085294
AUC: 0.501061
Avg Precision: 0.075010
Avg Recall: 1.000000
d_prime: 0.003763
train_loss: 0.209264
valid_loss: 0.775497
validation finished
Epoch-49 lr: 6.665790455522187e-10
epoch 49 training time: 18.451
---------------
2023-05-11 16:10:24.288599
current #epochs=50, #steps=2352
start validation
mAP: 0.085758
AUC: 0.501497
Avg Precision: 0.075199
Avg Recall: 1.000000
d_prime: 0.005307
train_loss: 0.209371
valid_loss: 0.775498
validation finished
Epoch-50 lr: 5.665921887193859e-10
epoch 50 training time: 18.453
---------------Training Finished---------------
weighted averaged model results
mAP: 0.088425
AUC: 0.490703
Avg Precision: 0.083994
Avg Recall: 1.000000
d_prime: -0.032959
train_loss: 0.000000
valid_loss: 0.775498
---------------evaluate on the train, validation, test set---------------
now train a audio spectrogram transformer model
---------------AST Model Summary---------------
ImageNet pretraining: True, AudioSet pretraining: True
frequncey stride=10, time stride=10
number of patches=600
balanced sampler is being used
---------------the train dataloader---------------
now using following mask: 24 freq, 96 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
(571, 88)
train auc:  0.5194249822499959
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
(68, 88)
val auc:  0.5481616511404835
---------------the evaluation dataloader---------------
now using following mask: 0 freq, 0 time
now using mix-up with rate 0.000000
now process audioset
use dataset mean -0.000 and std 0.003 to normalize the input.
number of classes is 88
(48, 88)
eval auc:  0.5019951217867299
